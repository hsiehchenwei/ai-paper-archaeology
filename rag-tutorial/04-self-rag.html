<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Self-RAG：自我反思的檢索增強生成 | RAG 演進史</title>
    <meta name="description" content="Self-RAG: Learning to Retrieve, Generate, and Critique through Self-Reflection 深度解析。引入 Reflection Tokens，讓模型學會自我批評與決策。" />
    <link rel="stylesheet" href="../styles/global.css" />
    <link rel="stylesheet" href="../styles/paper-reading.css" />
    <link rel="stylesheet" href="../styles/articles.css" />
  </head>
  <body>
    <div class="container">
      <!-- 麵包屑導航 -->
      <div class="breadcrumb">
        <a href="../index.html">🏠 首頁</a> / 
        <a href="index.html">📚 RAG 演進史</a> / 
        Self-RAG
      </div>

      <!-- 論文資訊卡 -->
      <div class="index-header" style="background: linear-gradient(135deg, var(--purple-color), #8b5cf6);">
        <h1>🔄 Self-RAG</h1>
        <p>Learning to Retrieve, Generate, and Critique<br />through Self-Reflection</p>
        <p style="font-size: 0.9rem; margin-top: 15px; opacity: 0.95;">
          Akari Asai, Zeqiu Wu, Yizhong Wang, Avirup Sil, Hannaneh Hajishirzi<br />
          <strong>2023 年 10 月</strong>
        </p>
        <p style="background: rgba(255,255,255,0.2); padding: 8px 16px; border-radius: 20px; margin-top: 15px; font-size: 0.9rem;">
          🧠 讓模型學會自我批評與決策
        </p>
      </div>

      <!-- 一句話總結 -->
      <div class="key-concept">
        <h4>💡 一句話總結</h4>
        <p style="font-size: 1.1rem;">
          Self-RAG 引入 <strong>Reflection Tokens</strong>，讓模型學會問自己：
          「我該檢索嗎？」「檢索結果相關嗎？」「我的回答有依據嗎？」
          從 Naive RAG 進化到 Advanced RAG 的關鍵技術。
        </p>
      </div>

      <!-- 論文 PDF 連結 -->
      <div style="background: var(--purple-light); padding: 15px; border-radius: var(--radius-md); margin: 30px 0; text-align: center;">
        <a href="papers/self-rag.pdf" target="_blank" style="color: var(--purple-color); font-weight: 600; text-decoration: none; font-size: 1.05rem;">
          📄 下載論文原文 PDF →
        </a>
      </div>

      <!-- Abstract 摘要 -->
      <h2>📄 Abstract (摘要)</h2>

      <div class="original-quote">
        <strong>📄 論文原文</strong><br><br>
        "Despite their remarkable capabilities, large language models (LLMs) often produce responses containing factual inaccuracies due to their sole reliance on the parametric knowledge they encapsulate. Retrieval-Augmented Generation (RAG), an ad hoc approach that augments LMs with retrieval of relevant knowledge, decreases such issues. However, indiscriminately retrieving and incorporating a fixed number of retrieved passages, regardless of whether retrieval is necessary, or passages are relevant, diminishes LM versatility or can lead to unhelpful response generation."
        <br><br>
        <strong>翻譯</strong>：儘管大型語言模型（LLM）具有卓越的能力，但由於它們僅依賴封裝在參數中的知識，經常產生包含事實錯誤的回應。檢索增強生成（RAG）是一種臨時方法，透過檢索相關知識來增強語言模型，減少了這類問題。然而，無論是否需要檢索或段落是否相關，都不加區別地檢索和整合固定數量的檢索段落，會降低語言模型的靈活性，或可能導致無用的回應生成。
      </div>

      <div class="explanation">
        <h4>🔍 Naive RAG 的問題</h4>
        <p>傳統 RAG 有兩個根本問題：</p>
        <ul>
          <li><strong>盲目檢索</strong>：不管是否需要，都會檢索固定數量的文檔</li>
          <li><strong>不判斷相關性</strong>：即使檢索到不相關的文檔，也會使用</li>
          <li><strong>不反思回答</strong>：生成答案後不會檢查是否有依據</li>
        </ul>
        <p style="margin-top: 15px; font-weight: 600; color: var(--purple-color);">
          Self-RAG 的解決方案：讓模型學會「自我反思」！
        </p>
      </div>

      <div class="original-quote">
        <strong>📄 論文原文（核心創新）</strong><br><br>
        "We introduce a new framework called Self-Reflective Retrieval-Augmented Generation (Self-RAG) that enhances an LM's quality and factuality through retrieval and self-reflection. Our framework trains a single arbitrary LM that adaptively retrieves passages on-demand, and generates and reflects on retrieved passages and its own generations using special tokens, called reflection tokens."
        <br><br>
        <strong>翻譯</strong>：我們引入了一個名為自我反思檢索增強生成（Self-RAG）的新框架，透過檢索和自我反思來增強語言模型的品質和事實性。我們的框架訓練單一任意語言模型，該模型按需自適應地檢索段落，並使用稱為反思 token 的特殊 token 來生成和反思檢索到的段落及其自己的生成。
      </div>

      <!-- 核心創新 -->
      <h2>🚀 核心創新：Reflection Tokens</h2>

      <div class="key-concept">
        <h4>🎯 四種 Reflection Tokens</h4>
        <p>Self-RAG 使用特殊 token 讓模型進行自我反思：</p>

        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 25px;">
          <div style="background: var(--primary-light); padding: 20px; border-radius: var(--radius-md); border-left: 4px solid var(--primary-color);">
            <h5 style="color: var(--primary-color); margin-top: 0;">🔍 Retrieve</h5>
            <p style="font-size: 0.95rem; line-height: 1.7;">
              <strong>問題：</strong>我該檢索嗎？<br />
              <strong>選項：</strong>Yes / No / Continue
            </p>
          </div>

          <div style="background: var(--secondary-light); padding: 20px; border-radius: var(--radius-md); border-left: 4px solid var(--secondary-color);">
            <h5 style="color: var(--secondary-color); margin-top: 0;">📄 ISREL</h5>
            <p style="font-size: 0.95rem; line-height: 1.7;">
              <strong>問題：</strong>檢索結果相關嗎？<br />
              <strong>選項：</strong>Relevant / Irrelevant
            </p>
          </div>

          <div style="background: var(--accent-light); padding: 20px; border-radius: var(--radius-md); border-left: 4px solid var(--accent-color);">
            <h5 style="color: var(--accent-color); margin-top: 0;">✅ ISSUP</h5>
            <p style="font-size: 0.95rem; line-height: 1.7;">
              <strong>問題：</strong>回答有依據嗎？<br />
              <strong>選項：</strong>Supported / Partially supported / Not supported
            </p>
          </div>

          <div style="background: var(--purple-light); padding: 20px; border-radius: var(--radius-md); border-left: 4px solid var(--purple-color);">
            <h5 style="color: var(--purple-color); margin-top: 0;">💬 ISUSE</h5>
            <p style="font-size: 0.95rem; line-height: 1.7;">
              <strong>問題：</strong>回答有用嗎？<br />
              <strong>選項：</strong>Useful / Not useful
            </p>
          </div>
        </div>
      </div>

      <div class="analogy">
        <h4>🎯 生活類比：自我檢查的研究員</h4>
        <p><strong>Naive RAG</strong> = 不思考的研究員</p>
        <ul>
          <li>看到問題就去查資料（不管是否需要）</li>
          <li>查到資料就用（不管是否相關）</li>
          <li>寫完報告就交（不管是否正確）</li>
        </ul>
        <p><strong>Self-RAG</strong> = 會自我檢查的研究員</p>
        <ul>
          <li>先問自己：「這個問題需要查資料嗎？」</li>
          <li>查完後問：「這些資料相關嗎？」</li>
          <li>寫完後問：「我的回答有依據嗎？有用嗎？」</li>
        </ul>
      </div>

      <!-- 工作流程 -->
      <h2>🔄 Self-RAG 工作流程</h2>

      <!-- 視覺化圖解 -->
      <div style="text-align: center; margin: 40px 0;">
        <img src="images/self-rag-reflection-flow.png" alt="Self-RAG Reflection Tokens 流程圖" style="max-width: 100%; border-radius: 12px; box-shadow: var(--shadow-lg);" />
        <p style="margin-top: 15px; color: var(--text-secondary); font-size: 0.9rem;">
          📊 Self-RAG 迭代生成與反思流程：從問題到答案的完整自我監督過程
        </p>
      </div>

      <div class="key-concept">
        <h4>💡 論文原始圖表</h4>
        <p>
          Self-RAG 論文中的 <strong>Figure 2</strong> 展示了完整的工作流程：
        </p>
        <ul>
          <li><strong>Adaptive Retrieval</strong>：使用 [Retrieve] token 決定是否檢索</li>
          <li><strong>Relevance Judgment</strong>：使用 [ISREL] token 評估檢索相關性</li>
          <li><strong>Support Verification</strong>：使用 [ISSUP] token 驗證生成內容是否有依據</li>
          <li><strong>Utility Assessment</strong>：使用 [ISUSE] token 評估答案有用性</li>
          <li><strong>Segment-wise Generation</strong>：逐段生成並反思</li>
        </ul>
        <p style="margin-top: 10px; font-size: 0.9rem; color: var(--text-secondary);">
          📄 請參考 <a href="papers/self-rag.pdf" target="_blank" style="color: var(--primary-color);">論文 PDF</a> 第 3 頁 Figure 2
        </p>
      </div>

      <div class="section-block">
        <h3>迭代式生成與反思</h3>
        <ol style="line-height: 2.2; font-size: 1.05rem;">
          <li><strong>判斷是否需要檢索</strong>：生成 Retrieve token (Yes/No/Continue)</li>
          <li><strong>如果需要檢索</strong>：檢索相關文檔</li>
          <li><strong>評估檢索結果</strong>：生成 ISREL token (Relevant/Irrelevant)</li>
          <li><strong>生成回答</strong>：基於檢索結果生成答案</li>
          <li><strong>反思回答</strong>：生成 ISSUP token (檢查是否有依據)</li>
          <li><strong>評估有用性</strong>：生成 ISUSE token (檢查是否有用)</li>
          <li><strong>如果回答不佳</strong>：回到步驟 1，重新檢索或生成</li>
        </ol>
      </div>

      <div class="key-concept" style="background: linear-gradient(135deg, #f3e8ff, #e9d5ff); padding: 25px; border-radius: var(--radius-md); margin: 30px 0;">
        <h4 style="color: var(--purple-color); margin-top: 0;">💡 關鍵優勢</h4>
        <ul style="line-height: 1.9;">
          <li><strong>自適應檢索</strong>：只在需要時檢索，節省計算資源</li>
          <li><strong>品質控制</strong>：自動判斷檢索結果和生成答案的品質</li>
          <li><strong>迭代改進</strong>：如果回答不佳，可以重新檢索或生成</li>
          <li><strong>可解釋性</strong>：Reflection tokens 提供決策過程的可視化</li>
        </ul>
      </div>

      <!-- 訓練方法 -->
      <h2>🎓 訓練方法</h2>

      <div class="explanation">
        <h4>📚 使用 GPT-4 生成反思標籤</h4>
        <p>Self-RAG 的訓練需要大量的反思標籤。論文使用 GPT-4 來生成這些標籤：</p>
        <ol style="line-height: 2;">
          <li>對每個查詢，使用 GPT-4 判斷是否需要檢索</li>
          <li>對檢索結果，使用 GPT-4 判斷是否相關</li>
          <li>對生成的答案，使用 GPT-4 判斷是否有依據和有用</li>
          <li>用這些標籤訓練模型生成 Reflection Tokens</li>
        </ol>
        <p style="margin-top: 15px; color: var(--text-secondary);">
          這是一個「用大模型訓練小模型」的範例，讓較小的模型也能具備自我反思能力。
        </p>
      </div>

      <!-- 實驗結果 -->
      <h2>📊 實驗結果</h2>

      <div class="solution">
        <h4>✅ 在知識密集型任務上的提升</h4>
        <p>Self-RAG 在多個任務上超越傳統 RAG：</p>
        <ul style="line-height: 2;">
          <li><strong>Open-Domain QA</strong>：準確率提升 5-10%</li>
          <li><strong>事實驗證</strong>：減少幻覺，提升可信度</li>
          <li><strong>長文本生成</strong>：更好的連貫性和相關性</li>
        </ul>
        <p style="margin-top: 15px; color: var(--text-secondary);">
          更重要的是，Self-RAG 在不需要檢索的任務上也能表現良好，
          因為它會自動判斷是否需要檢索。
        </p>
      </div>

      <!-- 與 Naive RAG 的比較 -->
      <h2>🔄 Self-RAG vs Naive RAG</h2>

      <div class="section-block">
        <table>
          <thead>
            <tr>
              <th>面向</th>
              <th>Naive RAG</th>
              <th>Self-RAG</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>檢索策略</strong></td>
              <td>固定檢索 k 個文檔</td>
              <td>自適應檢索（按需）</td>
            </tr>
            <tr>
              <td><strong>相關性判斷</strong></td>
              <td>不判斷</td>
              <td>自動判斷（ISREL）</td>
            </tr>
            <tr>
              <td><strong>答案驗證</strong></td>
              <td>不驗證</td>
              <td>自我反思（ISSUP, ISUSE）</td>
            </tr>
            <tr>
              <td><strong>迭代改進</strong></td>
              <td>單次生成</td>
              <td>可迭代改進</td>
            </tr>
            <tr>
              <td><strong>計算效率</strong></td>
              <td>總是檢索</td>
              <td>按需檢索，更高效</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- 歷史意義 -->
      <h2>📜 歷史意義</h2>

      <div class="key-concept">
        <h4>🌟 Self-RAG 的貢獻</h4>
        <ul>
          <li><strong>從 Naive 到 Advanced</strong>：開啟了 Advanced RAG 時代</li>
          <li><strong>自我反思機制</strong>：證明模型可以學會自我批評</li>
          <li><strong>自適應檢索</strong>：為後續的 Agentic RAG 鋪路</li>
          <li><strong>可解釋性</strong>：Reflection tokens 提供決策透明度</li>
        </ul>
        <p style="margin-top: 15px;">
          Self-RAG 發表於 2023 年 10 月，是 Advanced RAG 技術的代表作。
          它證明了 RAG 不僅可以「檢索」，還可以「思考」。
        </p>
      </div>

      <!-- 延伸閱讀 -->
      <div class="quick-links" style="margin-top: 40px;">
        <a href="03-retro.html" class="quick-link">← 上一篇：RETRO</a>
        <a href="index.html" class="quick-link">回到 RAG 總覽</a>
        <a href="05-graphrag.html" class="quick-link">下一篇：GraphRAG →</a>
      </div>

      <div class="quick-links" style="margin-top: 15px;">
        <a href="https://arxiv.org/abs/2310.11511" class="quick-link" target="_blank">📄 Self-RAG 論文 (arXiv)</a>
        <a href="https://github.com/AkariAsai/self-rag" class="quick-link" target="_blank">💻 GitHub 實作</a>
      </div>
    </div>
  </body>
</html>
