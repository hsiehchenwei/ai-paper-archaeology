<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬ä¸‰ç« ï¼šSelf-Attentionï¼ˆä¸Šï¼‰- Q/K/V å‘é‡ | nano-gpt è¦–è¦ºåŒ–æ•™å­¸</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700;900&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --hero-bg: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 50%, #0f1419 100%);
            --gold: #ffd700;
            --silver: #c0c0c0;
            --deep-blue: #0f1419;
            --matrix-green: #00ff41;
            --purple: #9333ea;
            --attention-brown: #daa520;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.8;
            color: #2c3e50;
            background: #ffffff;
        }

        /* ä½¿ç”¨èˆ‡ Layer Normalization ç›¸åŒçš„æ¨£å¼ */
        .hero-section {
            position: relative;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--hero-bg);
            overflow: hidden;
        }

        .hero-overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(
                180deg,
                rgba(10, 14, 39, 0.3) 0%,
                rgba(10, 14, 39, 0.85) 60%,
                rgba(10, 14, 39, 0.95) 100%
            );
            z-index: 1;
        }

        .hero-content {
            position: relative;
            z-index: 2;
            text-align: center;
            padding: 0 20px;
            max-width: 1000px;
        }

        .nano-gpt-badge {
            display: inline-block;
            background: rgba(218, 165, 32, 0.2);
            border: 2px solid var(--attention-brown);
            padding: 10px 30px;
            border-radius: 50px;
            color: var(--attention-brown);
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 30px;
            letter-spacing: 0.1em;
        }

        .hero-title {
            font-family: 'Noto Serif TC', serif;
            font-size: clamp(2.5rem, 6vw, 5rem);
            font-weight: 900;
            color: #FFFFFF;
            margin-bottom: 30px;
            text-shadow: 0 4px 30px rgba(0,0,0,0.8), 0 0 60px rgba(218, 165, 32, 0.3);
            letter-spacing: -0.02em;
            line-height: 1.2;
        }

        .hero-subtitle {
            font-family: 'Inter', sans-serif;
            font-size: clamp(1.2rem, 2.5vw, 1.8rem);
            color: var(--attention-brown);
            font-weight: 300;
            letter-spacing: 0.05em;
            text-shadow: 0 2px 20px rgba(0,0,0,0.6);
            margin-bottom: 20px;
        }

        /* Story Container */
        .story-container {
            background: #ffffff;
            margin-top: -50px;
            position: relative;
            z-index: 10;
            border-radius: 30px 30px 0 0;
            padding: 80px 40px;
        }

        .content-wrapper {
            max-width: 900px;
            margin: 0 auto;
        }

        /* Breadcrumb */
        .breadcrumb {
            padding: 20px 40px;
            background: rgba(10, 14, 39, 0.05);
            font-size: 0.9rem;
        }

        .breadcrumb a {
            color: var(--attention-brown);
            text-decoration: none;
            transition: opacity 0.3s;
        }

        .breadcrumb a:hover {
            opacity: 0.8;
        }

        /* Typography */
        .story-lead {
            font-family: 'Noto Serif TC', serif;
            font-size: 1.5rem;
            line-height: 2;
            color: #1a1a1a;
            margin: 40px 0;
            padding: 40px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-left: 5px solid var(--attention-brown);
            border-radius: 10px;
        }

        h2 {
            font-family: 'Noto Serif TC', serif;
            font-size: 2.5rem;
            font-weight: 700;
            color: #0a0e27;
            margin: 60px 0 30px 0;
            border-bottom: 3px solid var(--attention-brown);
            padding-bottom: 15px;
        }

        h3 {
            font-family: 'Noto Serif TC', serif;
            font-size: 1.8rem;
            color: #1a1f3a;
            margin: 40px 0 20px 0;
        }

        p {
            font-size: 1.1rem;
            line-height: 1.9;
            margin-bottom: 20px;
            color: #2c3e50;
        }

        /* Info Box */
        .info-box {
            background: linear-gradient(135deg, rgba(147, 51, 234, 0.1) 0%, rgba(147, 51, 234, 0.05) 100%);
            border: 2px solid var(--purple);
            border-radius: 15px;
            padding: 30px;
            margin: 40px 0;
        }

        .info-box-title {
            font-family: 'Inter', sans-serif;
            font-size: 1.3rem;
            color: var(--purple);
            font-weight: 700;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Matrix Box */
        .matrix-box {
            background: #1a1f3a;
            border-radius: 20px;
            padding: 40px;
            margin: 40px 0;
            box-shadow: 0 10px 50px rgba(0,0,0,0.3);
            border: 2px solid rgba(218, 165, 32, 0.2);
        }

        .matrix-title {
            font-family: 'Inter', sans-serif;
            font-size: 1.3rem;
            color: var(--attention-brown);
            text-align: center;
            margin-bottom: 30px;
            font-weight: 600;
            letter-spacing: 0.1em;
            text-transform: uppercase;
        }

        /* Code Block */
        .code-visualization {
            background: #1e1e1e;
            border-radius: 15px;
            padding: 30px;
            margin: 40px 0;
            overflow-x: auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .code-visualization pre {
            font-family: 'Courier New', monospace;
            font-size: 1rem;
            line-height: 1.8;
            color: #d4d4d4;
            margin: 0;
        }

        .code-comment { color: #6a9955; }
        .code-keyword { color: #569cd6; }
        .code-string { color: #ce9178; }
        .code-number { color: #b5cea8; }

        /* Step Box */
        .step-box {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            border-left: 5px solid var(--attention-brown);
        }

        .step-number {
            display: inline-block;
            width: 40px;
            height: 40px;
            background: var(--attention-brown);
            color: #0a0e27;
            border-radius: 50%;
            text-align: center;
            line-height: 40px;
            font-weight: bold;
            margin-right: 15px;
            font-size: 1.2rem;
        }

        .step-title {
            font-family: 'Noto Serif TC', serif;
            font-size: 1.4rem;
            color: #0a0e27;
            margin-bottom: 15px;
            font-weight: 700;
        }

        /* Pull Quote */
        .pull-quote {
            font-family: 'Noto Serif TC', serif;
            font-size: 1.8rem;
            font-style: italic;
            color: #0a0e27;
            padding: 40px;
            margin: 60px 0;
            background: linear-gradient(135deg, rgba(218, 165, 32, 0.1) 0%, rgba(218, 165, 32, 0.05) 100%);
            border-left: 5px solid var(--attention-brown);
            border-radius: 10px;
            position: relative;
        }

        .pull-quote::before {
            content: '"';
            position: absolute;
            left: 15px;
            top: 10px;
            font-size: 4rem;
            color: var(--attention-brown);
            opacity: 0.3;
            font-family: Georgia, serif;
        }

        /* Figure */
        figure {
            margin: 60px 0;
            text-align: center;
        }

        figure img {
            max-width: 100%;
            border-radius: 20px;
            box-shadow: 0 10px 50px rgba(0,0,0,0.3);
        }

        figcaption {
            margin-top: 20px;
            font-size: 1rem;
            color: #666;
            font-style: italic;
            line-height: 1.6;
        }

        /* Formula Box */
        .formula-box {
            background: linear-gradient(135deg, #fff9e6 0%, #fffbf0 100%);
            border: 2px solid var(--attention-brown);
            border-radius: 15px;
            padding: 40px;
            margin: 40px 0;
            text-align: center;
        }

        .formula-title {
            font-family: 'Noto Serif TC', serif;
            font-size: 1.3rem;
            color: #0a0e27;
            margin-bottom: 25px;
            font-weight: 700;
        }

        .formula {
            font-family: 'Courier New', monospace;
            font-size: 1.8rem;
            color: #0a0e27;
            margin: 20px 0;
            font-weight: 600;
        }

        .formula-desc {
            font-size: 1rem;
            color: #666;
            margin-top: 20px;
            line-height: 1.8;
        }

        /* Comparison Grid */
        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }

        .comparison-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            border-top: 4px solid var(--attention-brown);
            transition: transform 0.3s ease;
        }

        .comparison-card:hover {
            transform: translateY(-5px);
        }

        .card-title {
            font-family: 'Noto Serif TC', serif;
            font-size: 1.2rem;
            color: #0a0e27;
            margin-bottom: 15px;
            font-weight: 700;
        }

        /* Footer */
        .footer-quote {
            background: var(--hero-bg);
            padding: 80px 40px;
            text-align: center;
            margin-top: 100px;
        }

        .footer-quote-text {
            font-family: 'Noto Serif TC', serif;
            font-size: 2rem;
            color: var(--attention-brown);
            max-width: 800px;
            margin: 0 auto 30px;
            line-height: 1.8;
            text-shadow: 0 2px 20px rgba(0,0,0,0.6);
        }

        .footer-quote-author {
            font-family: 'Inter', sans-serif;
            font-size: 1.2rem;
            color: var(--silver);
            font-weight: 300;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero-title {
                font-size: 2rem;
            }
            
            .story-container {
                padding: 40px 20px;
            }
        }
    </style>
</head>
<body>
    <div class="breadcrumb">
        <a href="../../index.html">ğŸ  é¦–é </a>
        <span style="margin: 0 10px; color: #999;">/</span>
        <a href="../index.html">ğŸ“š LLM è¦–è¦ºåŒ–æ•™å­¸</a>
        <span style="margin: 0 10px; color: #999;">/</span>
        <span style="color: #666;">ç¬¬ä¸‰ç« ï¼šSelf-Attentionï¼ˆä¸Šï¼‰</span>
    </div>

    <!-- Hero Section -->
    <section class="hero-section">
        <div class="hero-overlay"></div>
        <div class="hero-content">
            <div class="nano-gpt-badge">nano-gpt Â· Transformer çš„å¿ƒè‡Ÿ</div>
            <h1 class="hero-title">Self-Attention (ä¸Š)</h1>
            <p class="hero-subtitle">è®“ Tokens ã€Œå°è©±ã€ï¼šQ/K/V å‘é‡çš„èª•ç”Ÿ</p>
            <p style="font-size: 1rem; color: var(--silver); margin-top: 20px;">
                Query Â· Key Â· Value
            </p>
        </div>
    </section>

    <!-- Main Content -->
    <div class="story-container">
        <div class="content-wrapper">
            
            <h2 style="border: none; margin-top: 0; text-align: center; color: var(--attention-brown);">ğŸ—ºï¸ æœ¬ç« åœ¨æ¶æ§‹ä¸­çš„ä½ç½®</h2>

            <div class="info-box" style="background: linear-gradient(135deg, rgba(218, 165, 32, 0.15) 0%, rgba(218, 165, 32, 0.08) 100%); border-color: var(--attention-brown); margin: 40px 0 60px 0;">
                <div style="text-align: center; margin-bottom: 30px;">
                    <div style="display: inline-block; padding: 15px 40px; background: rgba(218, 165, 32, 0.2); border: 2px solid var(--attention-brown); border-radius: 50px; font-size: 1.2rem; font-weight: 700; color: var(--attention-brown);">
                        ğŸ“ ç¬¬ä¸‰ç« ï¼šSelf-Attentionï¼ˆä¸ŠåŠéƒ¨ï¼‰
                    </div>
                </div>
                
                <figure style="margin: 30px 0;">
                    <img src="../../images/self_attention_chapter_focus_20260105212400.png" alt="Self-Attention ç« ç¯€æ¶æ§‹ç‰¹å¯«" style="max-width: 100%; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.2);">
                    <figcaption style="margin-top: 20px; font-size: 1rem; color: #666; line-height: 1.8;">
                        <strong style="color: #0a0e27;">Self-Attention ä½ç½®</strong><br>
                        æœ¬ç« èšç„¦æ–¼<span style="color: #daa520; font-weight: 700;"> ç±³è‰²å€åŸŸ</span>ï¼š<br>
                        Transformer çš„æ ¸å¿ƒ - Self-Attention æ©Ÿåˆ¶
                    </figcaption>
                </figure>

                <div style="background: rgba(255, 255, 255, 0.6); padding: 25px; border-radius: 12px; margin-top: 30px;">
                    <p style="margin: 0; text-align: center; color: #2c3e50; line-height: 1.9;">
                        <strong style="color: #daa520;">ğŸŸ¤ Self-Attention æ˜¯ Transformer çš„å¿ƒè‡Ÿ</strong><br>
                        é€™æ˜¯åˆ—ï¼ˆtokensï¼‰ä¹‹é–“ã€Œå°è©±ã€çš„éšæ®µã€‚<br>
                        åœ¨æ­¤ä¹‹å‰å’Œä¹‹å¾Œçš„æ‰€æœ‰éšæ®µï¼Œåˆ—éƒ½æ˜¯ç¨ç«‹è™•ç†çš„ã€‚
                    </p>
                </div>
            </div>
            
            <div class="story-lead">
                ã€ŒSelf-Attention å±¤å¯ä»¥èªªæ˜¯ Transformer å’Œ GPT çš„<strong>å¿ƒè‡Ÿ</strong>ã€‚<br>
                é€™æ˜¯ Input Embedding çŸ©é™£ä¸­çš„åˆ—ï¼ˆcolumnsï¼‰å½¼æ­¤ã€å°è©±ã€çš„éšæ®µã€‚<br><br>
                åˆ°ç›®å‰ç‚ºæ­¢ï¼Œä»¥åŠåœ¨æ‰€æœ‰å…¶ä»–éšæ®µï¼Œ<br>
                åˆ—éƒ½å¯ä»¥è¢«<strong>ç¨ç«‹</strong>çœ‹å¾…ã€‚ã€
            </div>

            <div class="info-box">
                <div class="info-box-title">
                    <span>ğŸ’¡</span>
                    <span>ç‚ºä»€éº¼ Self-Attention å¦‚æ­¤é‡è¦ï¼Ÿ</span>
                </div>
                <ul style="margin-left: 20px; line-height: 2;">
                    <li><strong>å”¯ä¸€çš„ã€Œæºé€šã€éšæ®µ</strong>ï¼šè®“ä¸åŒä½ç½®çš„ tokens èƒ½äº’ç›¸å½±éŸ¿</li>
                    <li><strong>æ•æ‰ä¸Šä¸‹æ–‡</strong>ï¼šç†è§£ã€ŒéŠ€è¡Œã€åœ¨ã€Œæ²³å²¸ã€æˆ–ã€Œé‡‘èã€çš„ä¸åŒå«ç¾©</li>
                    <li><strong>é•·è·é›¢ä¾è³´</strong>ï¼šè®“ç¬¬ 100 å€‹å­—èƒ½ã€Œçœ‹åˆ°ã€ç¬¬ 1 å€‹å­—çš„è³‡è¨Š</li>
                    <li><strong>å‹•æ…‹æ¬Šé‡</strong>ï¼šæ ¹æ“šå…§å®¹æ±ºå®šå“ªäº› tokens é‡è¦</li>
                </ul>
            </div>

            <h2>ğŸ¯ Self-Attention çš„æ•´é«”æµç¨‹</h2>

            <p>Self-Attention å±¤ç”±å¤šå€‹ <strong>heads</strong>ï¼ˆé ­ï¼‰çµ„æˆï¼Œæˆ‘å€‘å…ˆèšç„¦åœ¨<strong>å…¶ä¸­ä¸€å€‹ head</strong>ã€‚</p>

            <div class="matrix-box">
                <div class="matrix-title">Self-Attention ä¸‰å¤§æ­¥é©Ÿ</div>
                <div class="code-visualization">
                    <pre><span class="code-comment"># æ­¥é©Ÿ 1ï¼šç”Ÿæˆ Q/K/V å‘é‡</span>
<span class="code-keyword">for</span> each column <span class="code-keyword">in</span> input_matrix:
    Q_vector = Q_weights @ column + Q_bias
    K_vector = K_weights @ column + K_bias
    V_vector = V_weights @ column + V_bias

<span class="code-comment"># æ­¥é©Ÿ 2ï¼šè¨ˆç®—æ³¨æ„åŠ›åˆ†æ•¸</span>
<span class="code-keyword">for</span> each query:
    scores = Q @ K.T / sqrt(d_k)
    attention = softmax(scores)  <span class="code-comment"># æ­£è¦åŒ–ç‚ºæ©Ÿç‡</span>

<span class="code-comment"># æ­¥é©Ÿ 3ï¼šç”¢ç”Ÿè¼¸å‡º</span>
output = attention @ V</pre>
                </div>
            </div>

            <div class="pull-quote">
                æœ¬ç« ï¼ˆä¸ŠåŠéƒ¨ï¼‰å°ˆæ³¨æ–¼<strong>æ­¥é©Ÿ 1</strong>ï¼š<br>
                å¦‚ä½•å¾è¼¸å…¥ç”¢ç”Ÿ Qã€Kã€V ä¸‰ç¨®å‘é‡ã€‚<br><br>
                ä¸‹ä¸€ç« å°‡æ¢ç´¢å¦‚ä½•ä½¿ç”¨é€™äº›å‘é‡è¨ˆç®—æ³¨æ„åŠ›ã€‚
            </div>

            <h2>ğŸ“ æ­¥é©Ÿ 1ï¼šç”Ÿæˆ Q/K/V å‘é‡</h2>

            <p>ç¬¬ä¸€æ­¥æ˜¯ç‚ºæ­£è¦åŒ–å¾Œçš„ Input Embedding çŸ©é™£çš„æ¯ä¸€åˆ—ï¼ˆT å€‹åˆ—ï¼‰ç”¢ç”Ÿä¸‰å€‹å‘é‡ï¼š</p>

            <div class="comparison-grid">
                <div class="comparison-card" style="border-top-color: #4169e1;">
                    <div class="card-title" style="color: #4169e1;">Q: Query å‘é‡</div>
                    <p style="font-size: 0.95rem; color: #666;">ã€ŒæŸ¥è©¢ã€å‘é‡</p>
                    <p style="font-size: 0.9rem; color: #999; margin-top: 10px;">
                        ç”¨ä¾†è©¢å•ï¼š<br>
                        ã€Œæˆ‘éœ€è¦ä»€éº¼è³‡è¨Šï¼Ÿã€
                    </p>
                </div>

                <div class="comparison-card" style="border-top-color: #2e8b57;">
                    <div class="card-title" style="color: #2e8b57;">K: Key å‘é‡</div>
                    <p style="font-size: 0.95rem; color: #666;">ã€Œéµã€å‘é‡</p>
                    <p style="font-size: 0.9rem; color: #999; margin-top: 10px;">
                        ç”¨ä¾†å›ç­”ï¼š<br>
                        ã€Œæˆ‘æä¾›ä»€éº¼è³‡è¨Šï¼Ÿã€
                    </p>
                </div>

                <div class="comparison-card" style="border-top-color: #dc143c;">
                    <div class="card-title" style="color: #dc143c;">V: Value å‘é‡</div>
                    <p style="font-size: 0.95rem; color: #666;">ã€Œå€¼ã€å‘é‡</p>
                    <p style="font-size: 0.9rem; color: #999; margin-top: 10px;">
                        ç”¨ä¾†å‚³éï¼š<br>
                        ã€Œå¯¦éš›çš„å…§å®¹æ˜¯ä»€éº¼ï¼Ÿã€
                    </p>
                </div>
            </div>

            <h3>ğŸ”§ å¦‚ä½•ç”¢ç”Ÿé€™äº›å‘é‡ï¼Ÿ</h3>

            <p>è¦ç”¢ç”Ÿå…¶ä¸­ä¸€å€‹å‘é‡ï¼Œæˆ‘å€‘åŸ·è¡Œ<strong>çŸ©é™£-å‘é‡ä¹˜æ³•</strong>ä¸¦åŠ ä¸Šåå·®ï¼ˆbiasï¼‰ã€‚</p>

            <figure>
                <img src="../../images/qkv_generation_20260105212439.png" alt="Q/K/V å‘é‡ç”Ÿæˆéç¨‹">
                <figcaption>
                    è¦–è¦ºåŒ–ï¼šä½¿ç”¨æ¬Šé‡çŸ©é™£å’Œ Dot Product ç”Ÿæˆ Q/K/V å‘é‡
                </figcaption>
            </figure>

            <div class="step-box">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <span class="step-number">1</span>
                    <span class="step-title">çŸ©é™£-å‘é‡ä¹˜æ³•</span>
                </div>
                <p>ä¾‹å¦‚å°æ–¼ Q å‘é‡ï¼Œæˆ‘å€‘ç”¨ Q æ¬Šé‡çŸ©é™£çš„<strong>ä¸€åˆ—</strong>èˆ‡è¼¸å…¥çŸ©é™£çš„<strong>ä¸€è¡Œ</strong>é€²è¡Œé»ç©ï¼ˆdot productï¼‰ã€‚</p>
                
                <div class="formula-box">
                    <div class="formula-title">Dot Productï¼ˆé»ç©ï¼‰é‹ç®—</div>
                    <div class="formula">
                        aÂ·b = aâ‚bâ‚ + aâ‚‚bâ‚‚ + ... + aâ‚™bâ‚™
                    </div>
                    <div class="formula-desc">
                        å°‡å…©å€‹å‘é‡å°æ‡‰å…ƒç´ ç›¸ä¹˜ï¼Œç„¶å¾Œå…¨éƒ¨åŠ èµ·ä¾†
                    </div>
                </div>

                <div class="code-visualization">
                    <pre><span class="code-comment"># Dot Product ç¯„ä¾‹</span>
vector_a = [<span class="code-number">0.2</span>, <span class="code-number">-0.5</span>, <span class="code-number">0.8</span>]
vector_b = [<span class="code-number">0.1</span>, <span class="code-number">0.3</span>, <span class="code-number">-0.2</span>]

result = (<span class="code-number">0.2</span> * <span class="code-number">0.1</span>) + (<span class="code-number">-0.5</span> * <span class="code-number">0.3</span>) + (<span class="code-number">0.8</span> * <span class="code-number">-0.2</span>)
       = <span class="code-number">0.02</span> + (<span class="code-number">-0.15</span>) + (<span class="code-number">-0.16</span>)
       = <span class="code-number">-0.29</span></pre>
                </div>
            </div>

            <div class="info-box" style="background: linear-gradient(135deg, rgba(218, 165, 32, 0.1) 0%, rgba(218, 165, 32, 0.05) 100%); border-color: var(--attention-brown);">
                <div class="info-box-title" style="color: var(--attention-brown);">
                    <span>ğŸ”</span>
                    <span>ç‚ºä»€éº¼ä½¿ç”¨ Dot Productï¼Ÿ</span>
                </div>
                <p>é€™æ˜¯ä¸€ç¨®ç°¡å–®è€Œé€šç”¨çš„æ–¹å¼ï¼Œç¢ºä¿<strong>æ¯å€‹è¼¸å‡ºå…ƒç´ éƒ½èƒ½è¢«è¼¸å…¥å‘é‡çš„æ‰€æœ‰å…ƒç´ å½±éŸ¿</strong>ï¼ˆå½±éŸ¿ç¨‹åº¦ç”±æ¬Šé‡æ±ºå®šï¼‰ã€‚</p>
                <p style="margin-top: 15px;">å› æ­¤ï¼ŒDot Product åœ¨ç¥ç¶“ç¶²çµ¡ä¸­é »ç¹å‡ºç¾ã€‚</p>
            </div>

            <h3>ğŸ“ å®Œæ•´çš„ Q å‘é‡ç”Ÿæˆ</h3>

            <div class="matrix-box">
                <div class="matrix-title">ç”Ÿæˆ Q å‘é‡çš„å®Œæ•´éç¨‹</div>
                <div class="code-visualization">
                    <pre><span class="code-comment"># è¼¸å…¥ï¼šæ­£è¦åŒ–å¾Œçš„åˆ—å‘é‡ï¼ˆä¾†è‡ª Layer Normï¼‰</span>
input_column = [<span class="code-number">48</span> å€‹æµ®é»æ•¸]  <span class="code-comment"># é•·åº¦ C = 48</span>

<span class="code-comment"># Q æ¬Šé‡çŸ©é™£ï¼š[16 Ã— 48]</span>
<span class="code-comment"># - 16 è¡Œï¼šQ å‘é‡çš„é•·åº¦ï¼ˆhead çš„ç¶­åº¦ï¼‰</span>
<span class="code-comment"># - 48 åˆ—ï¼šèˆ‡è¼¸å…¥å‘é‡é•·åº¦åŒ¹é…</span>

<span class="code-comment"># è¨ˆç®— Q å‘é‡çš„æ¯å€‹å…ƒç´ </span>
Q_vector = []
<span class="code-keyword">for</span> i <span class="code-keyword">in</span> <span class="code-keyword">range</span>(<span class="code-number">16</span>):
    <span class="code-comment"># å– Q æ¬Šé‡çŸ©é™£çš„ç¬¬ i åˆ—</span>
    weight_row = Q_weights[i]  <span class="code-comment"># [48 å€‹æ¬Šé‡]</span>
    
    <span class="code-comment"># èˆ‡è¼¸å…¥åˆ—å‘é‡åšé»ç©</span>
    dot_product = <span class="code-keyword">sum</span>(weight_row[j] * input_column[j] 
                      <span class="code-keyword">for</span> j <span class="code-keyword">in</span> <span class="code-keyword">range</span>(<span class="code-number">48</span>))
    
    <span class="code-comment"># åŠ ä¸Šåå·®</span>
    Q_vector[i] = dot_product + Q_bias[i]

<span class="code-comment"># çµæœï¼šQ å‘é‡ [16 å€‹æµ®é»æ•¸]</span></pre>
                </div>
            </div>

            <h2>ğŸ”¢ é—œéµå•é¡Œï¼šç¶­åº¦çš„ç§˜å¯†</h2>

            <div class="info-box" style="background: linear-gradient(135deg, rgba(255, 87, 51, 0.1) 0%, rgba(255, 87, 51, 0.05) 100%); border-color: #ff5733;">
                <div class="info-box-title" style="color: #ff5733;">
                    <span>â“</span>
                    <span>ç‚ºä»€éº¼æ¬Šé‡çŸ©é™£æ˜¯ [16 Ã— 48]ï¼Ÿ</span>
                </div>
                <p style="font-size: 1.2rem; line-height: 2;">è®“æˆ‘å€‘é€ä¸€æ‹†è§£é€™å…©å€‹æ•¸å­—çš„å«ç¾©ï¼š</p>
            </div>

            <h3>ğŸ“Š ç¶­åº¦ 1ï¼šç‚ºä½•æ˜¯ 16ï¼Ÿ</h3>

            <div class="step-box">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <span class="step-number">?</span>
                    <span class="step-title" style="color: #ff5733;">16 ä»£è¡¨è¼¸å‡ºå‘é‡çš„é•·åº¦ï¼ˆhead çš„ç¶­åº¦ï¼‰</span>
                </div>
                
                <div class="matrix-box" style="margin-top: 20px;">
                    <div class="code-visualization">
                        <pre><span class="code-comment"># ç‚ºä½•æ˜¯ 16ï¼Ÿé€™æ˜¯è¨­è¨ˆé¸æ“‡ï¼</span>

C (æ¨¡å‹ç¶­åº¦) = <span class="code-number">48</span>
num_heads = <span class="code-number">3</span>

head_dim = C / num_heads = <span class="code-number">48</span> / <span class="code-number">3</span> = <span class="code-number">16</span>

<span class="code-comment"># 16 ä¸æ˜¯é­”æ³•æ•¸å­—ï¼Œè€Œæ˜¯æ ¹æ“šï¼š</span>
<span class="code-comment"># 1. æ¨¡å‹ç¶­åº¦ Cï¼ˆé€™æ˜¯æ¶æ§‹å¸«çš„é¸æ“‡ï¼‰</span>
<span class="code-comment"># 2. è¦ç”¨å¹¾å€‹ headsï¼ˆä¹Ÿæ˜¯æ¶æ§‹å¸«çš„é¸æ“‡ï¼‰</span>
<span class="code-comment"># 3. ç¢ºä¿ C èƒ½è¢« num_heads æ•´é™¤</span>

<span class="code-comment"># å¦‚æœæ›æˆ GPT-2ï¼š</span>
<span class="code-comment"># C = 768, num_heads = 12</span>
<span class="code-comment"># head_dim = 768 / 12 = 64</span></pre>
                    </div>
                </div>

                <p style="margin-top: 20px;"><strong>ç°¡å–®ä¾†èªªï¼š</strong></p>
                <ul style="margin-left: 20px; line-height: 2;">
                    <li><strong>16</strong> æ˜¯æ¯å€‹ head çš„è¼¸å‡ºç¶­åº¦</li>
                    <li>é€™å€‹æ•¸å­—ç”±<strong>æ¨¡å‹è¨­è¨ˆ</strong>æ±ºå®šï¼ˆC Ã· num_headsï¼‰</li>
                    <li>å°æ–¼ nano-gptï¼š48 Ã· 3 = 16</li>
                    <li>å°æ–¼ GPT-2ï¼š768 Ã· 12 = 64</li>
                </ul>
            </div>

            <h3>ğŸ“Š ç¶­åº¦ 2ï¼šç‚ºä½•æ˜¯ 48ï¼Ÿ</h3>

            <div class="step-box">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <span class="step-number">?</span>
                    <span class="step-title" style="color: #ff5733;">48 ä»£è¡¨è¼¸å…¥å‘é‡çš„é•·åº¦ï¼ˆæ¨¡å‹ç¶­åº¦ Cï¼‰</span>
                </div>
                
                <div class="matrix-box" style="margin-top: 20px;">
                    <div class="code-visualization">
                        <pre><span class="code-comment"># ç‚ºä½•æ˜¯ 48ï¼Ÿé€™ä¹Ÿæ˜¯è¨­è¨ˆé¸æ“‡ï¼</span>

<span class="code-comment"># nano-gpt çš„æ¶æ§‹å¸«é¸æ“‡ï¼š</span>
C (model dimension) = <span class="code-number">48</span>

<span class="code-comment"># é€™æ„å‘³è‘—ï¼š</span>
<span class="code-comment"># - æ¯å€‹ token ç”¨ 48 å€‹æ•¸å­—è¡¨ç¤º</span>
<span class="code-comment"># - Input Embedding çŸ©é™£æ˜¯ [T Ã— 48]</span>
<span class="code-comment"># - æ¬Šé‡çŸ©é™£å¿…é ˆåŒ¹é…é€™å€‹ç¶­åº¦</span>

<span class="code-comment"># æ¬Šé‡çŸ©é™£çš„ç¬¬äºŒå€‹ç¶­åº¦ï¼ˆ48ï¼‰å¿…é ˆç­‰æ–¼è¼¸å…¥ç¶­åº¦</span>
<span class="code-comment"># é€™æ¨£æ‰èƒ½åšçŸ©é™£ä¹˜æ³•ï¼</span>

<span class="code-comment"># [16 Ã— 48] @ [48 Ã— 1] = [16 Ã— 1] âœ…</span>
<span class="code-comment">#  ^^^^      ^^^^         ^^^^</span>
<span class="code-comment">#  è¼¸å‡º     å¿…é ˆåŒ¹é…      è¼¸å‡º</span></pre>
                    </div>
                </div>

                <p style="margin-top: 20px;"><strong>ç°¡å–®ä¾†èªªï¼š</strong></p>
                <ul style="margin-left: 20px; line-height: 2;">
                    <li><strong>48</strong> æ˜¯æ¨¡å‹çš„ã€Œèªè¨€ã€ç¶­åº¦</li>
                    <li>æ‰€æœ‰ token éƒ½ç”¨ 48 ç¶­å‘é‡è¡¨ç¤º</li>
                    <li>æ¬Šé‡çŸ©é™£çš„åˆ—æ•¸<strong>å¿…é ˆ</strong>ç­‰æ–¼ 48ï¼Œæ‰èƒ½è™•ç†é€™äº›å‘é‡</li>
                    <li>é€™æ˜¯<strong>å›ºå®šçš„</strong>ï¼Œåœ¨è¨“ç·´æ™‚å°±ç¢ºå®šäº†</li>
                </ul>
            </div>

            <h3>ğŸ”‘ æ ¸å¿ƒå•é¡Œï¼šæ¬Šé‡ç‚ºä½•æ˜¯å›ºå®šçš„ï¼Œä½†åºåˆ—é•·åº¦å¯è®Šï¼Ÿ</h3>

            <div class="pull-quote">
                é€™æ˜¯ Transformer è¨­è¨ˆçš„ç²¾å¦™ä¹‹è™•ï¼<br><br>
                <strong>æ¬Šé‡çŸ©é™£ [16 Ã— 48] æ˜¯å›ºå®šçš„</strong>ï¼Œ<br>
                ä½†å®ƒå¯ä»¥è™•ç†<strong>ä»»æ„é•·åº¦</strong>çš„è¼¸å…¥åºåˆ—ã€‚
            </div>

            <figure>
                <img src="../../images/weight_matrix_dimensions_20260105220906.png" alt="æ¬Šé‡çŸ©é™£ç¶­åº¦èˆ‡åºåˆ—é•·åº¦é—œä¿‚">
                <figcaption>
                    è¦–è¦ºåŒ–ï¼šå›ºå®šçš„æ¬Šé‡çŸ©é™£å¯ä»¥è™•ç†ä¸åŒé•·åº¦çš„è¼¸å…¥åºåˆ—
                </figcaption>
            </figure>

            <div class="matrix-box" style="background: linear-gradient(135deg, #1e3a2f 0%, #0f1e18 100%);">
                <div class="matrix-title" style="color: var(--matrix-green);">æ¬Šé‡å›ºå®š vs åºåˆ—é•·åº¦å¯è®Š</div>
                <div class="code-visualization">
                    <pre><span class="code-comment"># æ¬Šé‡çŸ©é™£ï¼šå›ºå®šä¸è®Š</span>
Q_weights = [<span class="code-number">16</span> Ã— <span class="code-number">48</span>]  <span class="code-comment"># æ°¸é æ˜¯é€™å€‹å¤§å°</span>

<span class="code-comment">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="code-comment"># å ´æ™¯ 1ï¼šè¼¸å…¥ 3 å€‹ tokens</span>
<span class="code-comment">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
input = [<span class="code-number">3</span> Ã— <span class="code-number">48</span>]  <span class="code-comment"># 3 å€‹ tokensï¼Œæ¯å€‹ 48 ç¶­</span>

<span class="code-comment"># å°æ¯å€‹ token åˆ†åˆ¥è™•ç†</span>
Q[<span class="code-number">0</span>] = Q_weights @ input[<span class="code-number">0</span>]  <span class="code-comment"># [16Ã—48] @ [48] = [16]</span>
Q[<span class="code-number">1</span>] = Q_weights @ input[<span class="code-number">1</span>]  <span class="code-comment"># [16Ã—48] @ [48] = [16]</span>
Q[<span class="code-number">2</span>] = Q_weights @ input[<span class="code-number">2</span>]  <span class="code-comment"># [16Ã—48] @ [48] = [16]</span>

output = [<span class="code-number">3</span> Ã— <span class="code-number">16</span>]  <span class="code-comment"># 3 å€‹ Q å‘é‡</span>

<span class="code-comment">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="code-comment"># å ´æ™¯ 2ï¼šè¼¸å…¥ 6 å€‹ tokensï¼ˆnano-gptï¼‰</span>
<span class="code-comment">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
input = [<span class="code-number">6</span> Ã— <span class="code-number">48</span>]  <span class="code-comment"># 6 å€‹ tokensï¼Œæ¯å€‹ 48 ç¶­</span>

<span class="code-comment"># åŒæ¨£çš„æ¬Šé‡ï¼Œè™•ç† 6 å€‹ tokens</span>
Q[<span class="code-number">0</span>] = Q_weights @ input[<span class="code-number">0</span>]  <span class="code-comment"># [16Ã—48] @ [48] = [16]</span>
Q[<span class="code-number">1</span>] = Q_weights @ input[<span class="code-number">1</span>]  <span class="code-comment"># [16Ã—48] @ [48] = [16]</span>
...
Q[<span class="code-number">5</span>] = Q_weights @ input[<span class="code-number">5</span>]  <span class="code-comment"># [16Ã—48] @ [48] = [16]</span>

output = [<span class="code-number">6</span> Ã— <span class="code-number">16</span>]  <span class="code-comment"># 6 å€‹ Q å‘é‡</span>

<span class="code-comment">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="code-comment"># å ´æ™¯ 3ï¼šè¼¸å…¥ 100 å€‹ tokens</span>
<span class="code-comment">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
input = [<span class="code-number">100</span> Ã— <span class="code-number">48</span>]  <span class="code-comment"># 100 å€‹ tokensï¼Œæ¯å€‹ 48 ç¶­</span>

<span class="code-comment"># åŒæ¨£çš„æ¬Šé‡ï¼Œè™•ç† 100 å€‹ tokensï¼</span>
<span class="code-keyword">for</span> t <span class="code-keyword">in</span> <span class="code-keyword">range</span>(<span class="code-number">100</span>):
    Q[t] = Q_weights @ input[t]  <span class="code-comment"># [16Ã—48] @ [48] = [16]</span>

output = [<span class="code-number">100</span> Ã— <span class="code-number">16</span>]  <span class="code-comment"># 100 å€‹ Q å‘é‡</span>

<span class="code-comment">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="code-comment"># é—œéµï¼šæ¬Šé‡çŸ©é™£ [16 Ã— 48] å¾æœªæ”¹è®Šï¼</span>
<span class="code-comment"># å®ƒæ˜¯ã€Œper-tokenã€è™•ç†ï¼Œä¸ç®¡æœ‰å¹¾å€‹ tokens</span>
<span class="code-comment">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></pre>
                </div>
            </div>

            <div class="info-box" style="background: linear-gradient(135deg, rgba(255, 215, 0, 0.1) 0%, rgba(255, 215, 0, 0.05) 100%); border-color: var(--gold);">
                <div class="info-box-title" style="color: var(--gold);">
                    <span>ğŸ’¡</span>
                    <span>ç†è§£é—œéµé»</span>
                </div>
                
                <h4 style="margin-top: 20px; color: #0a0e27; font-size: 1.3rem;">1ï¸âƒ£ æ¬Šé‡çŸ©é™£è™•ç†çš„æ˜¯ã€Œå–®å€‹ tokenã€</h4>
                <p>æ¬Šé‡çŸ©é™£ [16 Ã— 48] æ¯æ¬¡è™•ç†<strong>ä¸€å€‹</strong> [48] ç¶­çš„ token å‘é‡ï¼Œè¼¸å‡º<strong>ä¸€å€‹</strong> [16] ç¶­çš„å‘é‡ã€‚</p>
                <div class="formula-box" style="margin: 20px 0;">
                    <div class="formula">
                        [16 Ã— 48] @ [48] = [16]
                    </div>
                    <div class="formula-desc">
                        é€™æ˜¯å–®æ¬¡æ“ä½œçš„ç¶­åº¦
                    </div>
                </div>

                <h4 style="margin-top: 30px; color: #0a0e27; font-size: 1.3rem;">2ï¸âƒ£ å°æ¯å€‹ token é‡è¤‡ç›¸åŒæ“ä½œ</h4>
                <p>ä¸ç®¡è¼¸å…¥æœ‰ 3 å€‹ã€6 å€‹ã€é‚„æ˜¯ 100 å€‹ tokensï¼Œ<strong>æ¯å€‹ token éƒ½ç”¨åŒæ¨£çš„æ¬Šé‡çŸ©é™£</strong>è™•ç†ã€‚</p>
                <div class="formula-box" style="margin: 20px 0;">
                    <div class="formula" style="font-size: 1.3rem;">
                        Input [T Ã— 48] â†’ Output [T Ã— 16]
                    </div>
                    <div class="formula-desc">
                        T æ˜¯åºåˆ—é•·åº¦ï¼Œå¯ä»¥è®ŠåŒ–<br>
                        48ï¼ˆè¼¸å…¥ç¶­åº¦ï¼‰å’Œ 16ï¼ˆè¼¸å‡ºç¶­åº¦ï¼‰å›ºå®š
                    </div>
                </div>

                <h4 style="margin-top: 30px; color: #0a0e27; font-size: 1.3rem;">3ï¸âƒ£ ç‚ºä»€éº¼å¯ä»¥é€™æ¨£è¨­è¨ˆï¼Ÿ</h4>
                <ul style="margin-left: 20px; line-height: 2; margin-top: 15px;">
                    <li><strong>æ¬Šé‡å…±äº«</strong>ï¼šåŒæ¨£çš„è½‰æ›é‚è¼¯é©ç”¨æ–¼æ‰€æœ‰ tokens</li>
                    <li><strong>åƒæ•¸æ•ˆç‡</strong>ï¼šä¸éœ€è¦ç‚ºæ¯å€‹ä½ç½®æº–å‚™ä¸åŒçš„æ¬Šé‡</li>
                    <li><strong>æ³›åŒ–èƒ½åŠ›</strong>ï¼šè¨“ç·´æ™‚çœ‹éçš„åºåˆ—é•·åº¦ï¼Œæ¨ç†æ™‚å¯ä»¥è™•ç†å…¶ä»–é•·åº¦</li>
                </ul>

                <h4 style="margin-top: 30px; color: #0a0e27; font-size: 1.3rem;">4ï¸âƒ£ å¯¦éš›é™åˆ¶</h4>
                <p>é›–ç„¶æ¬Šé‡çŸ©é™£å¯ä»¥è™•ç†ä»»æ„é•·åº¦ï¼Œä½†å¯¦éš›ä¸Šæœ‰é™åˆ¶ï¼š</p>
                <ul style="margin-left: 20px; line-height: 2; margin-top: 10px;">
                    <li><strong>Position Embedding é™åˆ¶</strong>ï¼šåªé è¨“ç·´äº†å›ºå®šé•·åº¦çš„ä½ç½®ç·¨ç¢¼</li>
                    <li><strong>è¨ˆç®—è³‡æºé™åˆ¶</strong>ï¼šåºåˆ—è¶Šé•·ï¼ŒAttention è¨ˆç®—é‡è¶Šå¤§ï¼ˆO(TÂ²)ï¼‰</li>
                    <li><strong>ä¸Šä¸‹æ–‡çª—å£</strong>ï¼šæ¨¡å‹è¨­è¨ˆæ™‚æœƒè¨­å®šæœ€å¤§åºåˆ—é•·åº¦ï¼ˆå¦‚ GPT-2 æ˜¯ 1024ï¼‰</li>
                </ul>
            </div>

            <h3>ğŸ“ çŸ©é™£é‹ç®—çš„æ•¸å­¸</h3>

            <div class="matrix-box">
                <div class="matrix-title">å®Œæ•´çš„çŸ©é™£é‹ç®—ç¶­åº¦è¿½è¹¤</div>
                <div class="code-visualization">
                    <pre><span class="code-comment"># nano-gpt çš„å¯¦éš›æ•¸å€¼</span>

<span class="code-comment">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="code-comment"># è¼¸å…¥éšæ®µ</span>
<span class="code-comment">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
tokens = [<span class="code-string">"C"</span>, <span class="code-string">"B"</span>, <span class="code-string">"A"</span>, <span class="code-string">"B"</span>, <span class="code-string">"B"</span>, <span class="code-string">"C"</span>]  <span class="code-comment"># 6 å€‹ tokens</span>
token_indices = [<span class="code-number">2</span>, <span class="code-number">1</span>, <span class="code-number">0</span>, <span class="code-number">1</span>, <span class="code-number">1</span>, <span class="code-number">2</span>]

<span class="code-comment"># Token Embedding + Position Embedding</span>
input_embedding = [<span class="code-number">6</span> Ã— <span class="code-number">48</span>]
                   <span class="code-comment">â†‘    â†‘</span>
                   <span class="code-comment">T    C</span>
                   <span class="code-comment">åºåˆ—  æ¨¡å‹</span>
                   <span class="code-comment">é•·åº¦  ç¶­åº¦</span>

<span class="code-comment">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="code-comment"># Layer Normalization</span>
<span class="code-comment">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
normalized = layer_norm(input_embedding)  <span class="code-comment"># [6 Ã— 48]</span>

<span class="code-comment">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="code-comment"># Q/K/V ç”Ÿæˆï¼ˆä»¥ Q ç‚ºä¾‹ï¼‰</span>
<span class="code-comment">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
Q_weights = [<span class="code-number">16</span> Ã— <span class="code-number">48</span>]
             <span class="code-comment">â†‘     â†‘</span>
             <span class="code-comment">head  è¼¸å…¥</span>
             <span class="code-comment">ç¶­åº¦  ç¶­åº¦</span>

<span class="code-comment"># è™•ç†æ¯å€‹ tokenï¼ˆæŒ‰åˆ—ï¼‰</span>
<span class="code-keyword">for</span> t <span class="code-keyword">in</span> <span class="code-keyword">range</span>(<span class="code-number">6</span>):
    input_vector = normalized[t, :]  <span class="code-comment"># [48]ï¼ˆç¬¬ t å€‹ tokenï¼‰</span>
    
    <span class="code-comment"># çŸ©é™£-å‘é‡ä¹˜æ³•</span>
    Q[t] = Q_weights @ input_vector + Q_bias
           <span class="code-comment">â†“</span>
           [<span class="code-number">16</span> Ã— <span class="code-number">48</span>] @ [<span class="code-number">48</span>] + [<span class="code-number">16</span>] = [<span class="code-number">16</span>]

<span class="code-comment"># çµæœ</span>
Q = [<span class="code-number">6</span> Ã— <span class="code-number">16</span>]
     <span class="code-comment">â†‘    â†‘</span>
     <span class="code-comment">T    head_dim</span>
     <span class="code-comment">åºåˆ—  (C/num_heads)</span>
     <span class="code-comment">é•·åº¦</span>

<span class="code-comment">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="code-comment"># é—œéµè§€å¯Ÿ</span>
<span class="code-comment">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="code-comment"># è¼¸å…¥ï¼š[T Ã— 48]  â† T å¯è®Šï¼ˆ3, 6, 100...ï¼‰</span>
<span class="code-comment"># æ¬Šé‡ï¼š[16 Ã— 48] â† å›ºå®šä¸è®Š</span>
<span class="code-comment"># è¼¸å‡ºï¼š[T Ã— 16]  â† T è·Ÿè‘—è¼¸å…¥è®Š</span>

<span class="code-comment"># ç¬¬ä¸€ç¶­ï¼ˆTï¼‰ï¼šåºåˆ—é•·åº¦ï¼Œå¯è®Š</span>
<span class="code-comment"># ç¬¬äºŒç¶­ï¼ˆ48 â†’ 16ï¼‰ï¼šç”±æ¬Šé‡çŸ©é™£æ±ºå®šï¼Œå›ºå®š</span></pre>
                </div>
            </div>

            <div class="step-box">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <span class="step-number">2</span>
                    <span class="step-title">å°æ‰€æœ‰è¼¸å‡ºå–®å…ƒæ ¼é‡è¤‡</span>
                </div>
                <p>æˆ‘å€‘å° Qã€Kã€V å‘é‡ä¸­çš„æ¯å€‹è¼¸å‡ºå–®å…ƒæ ¼é‡è¤‡é€™å€‹æ“ä½œï¼š</p>
            </div>

            <div class="matrix-box">
                <div class="matrix-title">ç‚ºæ‰€æœ‰ 6 åˆ—ç”Ÿæˆ Q/K/V å‘é‡</div>
                <div class="code-visualization">
                    <pre><span class="code-comment"># è¼¸å…¥ï¼šæ­£è¦åŒ–å¾Œçš„çŸ©é™£ [6 Ã— 48]</span>

Position   Input (48ç¶­)    â†’    Q (16ç¶­)    K (16ç¶­)    V (16ç¶­)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   0       [48å€‹æ•¸]        â†’    [16å€‹æ•¸]    [16å€‹æ•¸]    [16å€‹æ•¸]
   1       [48å€‹æ•¸]        â†’    [16å€‹æ•¸]    [16å€‹æ•¸]    [16å€‹æ•¸]
   2       [48å€‹æ•¸]        â†’    [16å€‹æ•¸]    [16å€‹æ•¸]    [16å€‹æ•¸]
   3       [48å€‹æ•¸]        â†’    [16å€‹æ•¸]    [16å€‹æ•¸]    [16å€‹æ•¸]
   4       [48å€‹æ•¸]        â†’    [16å€‹æ•¸]    [16å€‹æ•¸]    [16å€‹æ•¸]
   5       [48å€‹æ•¸]        â†’    [16å€‹æ•¸]    [16å€‹æ•¸]    [16å€‹æ•¸]

<span class="code-comment"># æ¯å€‹ token ç¾åœ¨éƒ½æœ‰è‡ªå·±çš„ Qã€Kã€V å‘é‡</span>
<span class="code-comment"># Q/K/V å‘é‡é•·åº¦ = 16ï¼ˆé€™æ˜¯ head çš„ç¶­åº¦ï¼ŒC/num_heads = 48/3ï¼‰</span></pre>
                </div>
            </div>

            <h2>ğŸ“ nano-gpt çš„å…·é«”æ•¸å€¼</h2>

            <div class="matrix-box">
                <div class="code-visualization">
                    <pre><span class="code-comment"># nano-gpt Self-Attention é…ç½®ï¼ˆå–®å€‹ headï¼‰</span>

è¼¸å…¥ç¶­åº¦ï¼ˆCï¼‰ï¼š<span class="code-number">48</span>
Head ç¶­åº¦ï¼š    <span class="code-number">16</span> <span class="code-comment"># C / num_heads = 48 / 3</span>

<span class="code-comment"># æ¬Šé‡çŸ©é™£å¤§å°</span>
Q_weights: [<span class="code-number">16</span> Ã— <span class="code-number">48</span>] = <span class="code-number">768</span> å€‹åƒæ•¸
K_weights: [<span class="code-number">16</span> Ã— <span class="code-number">48</span>] = <span class="code-number">768</span> å€‹åƒæ•¸
V_weights: [<span class="code-number">16</span> Ã— <span class="code-number">48</span>] = <span class="code-number">768</span> å€‹åƒæ•¸

<span class="code-comment"># åå·®ï¼ˆbiasï¼‰</span>
Q_bias: [<span class="code-number">16</span>] = <span class="code-number">16</span> å€‹åƒæ•¸
K_bias: [<span class="code-number">16</span>] = <span class="code-number">16</span> å€‹åƒæ•¸
V_bias: [<span class="code-number">16</span>] = <span class="code-number">16</span> å€‹åƒæ•¸

<span class="code-comment"># å–®å€‹ head çš„ç¸½åƒæ•¸</span>
Total = (<span class="code-number">768</span> + <span class="code-number">16</span>) * <span class="code-number">3</span> = <span class="code-number">2,352</span> å€‹åƒæ•¸

<span class="code-comment"># è¼¸å‡ºå‘é‡</span>
æ¯å€‹ token çš„ Q/K/V å‘é‡ï¼š[<span class="code-number">16</span>]
æ‰€æœ‰ tokens çš„ Q/K/V çŸ©é™£ï¼š[<span class="code-number">6</span> Ã— <span class="code-number">16</span>]</pre>
                </div>
            </div>

            <h2>ğŸ”‘ æ¬Šé‡çŸ©é™£å¾ä½•è€Œä¾†ï¼Ÿ</h2>

            <div class="info-box" style="background: linear-gradient(135deg, rgba(255, 87, 51, 0.1) 0%, rgba(255, 87, 51, 0.05) 100%); border-color: #ff5733;">
                <div class="info-box-title" style="color: #ff5733;">
                    <span>ğŸ¯</span>
                    <span>é—œéµå•é¡Œï¼šé€™äº›æ¬Šé‡æ˜¯å¦‚ä½•ç²å¾—çš„ï¼Ÿ</span>
                </div>
                <p style="font-size: 1.2rem; font-weight: 600; color: #0a0e27;">
                    ç­”æ¡ˆï¼šé€é<strong>è¨“ç·´ï¼ˆTrainingï¼‰</strong>å­¸ç¿’è€Œä¾†ï¼
                </p>
            </div>

            <h3>ğŸ“š æ¬Šé‡çš„ç”Ÿå‘½é€±æœŸ</h3>

            <div class="step-box">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <span class="step-number">1</span>
                    <span class="step-title">éš¨æ©Ÿåˆå§‹åŒ–ï¼ˆRandom Initializationï¼‰</span>
                </div>
                <p>åœ¨è¨“ç·´é–‹å§‹å‰ï¼Œæ‰€æœ‰æ¬Šé‡éƒ½è¢«è³¦äºˆ<strong>å°çš„éš¨æ©Ÿå€¼</strong>ã€‚</p>
                
                <div class="matrix-box" style="margin-top: 20px;">
                    <div class="code-visualization">
                        <pre><span class="code-comment"># è¨“ç·´å‰ï¼šéš¨æ©Ÿåˆå§‹åŒ–</span>
<span class="code-keyword">import</span> numpy <span class="code-keyword">as</span> np

<span class="code-comment"># Q æ¬Šé‡çŸ©é™£ [16 Ã— 48]</span>
Q_weights = np.random.randn(<span class="code-number">16</span>, <span class="code-number">48</span>) * <span class="code-number">0.02</span>
<span class="code-comment"># ä¾‹å¦‚ï¼š</span>
<span class="code-comment"># [[0.012, -0.008, 0.015, ...],</span>
<span class="code-comment">#  [-0.003, 0.021, -0.011, ...],</span>
<span class="code-comment">#  ...]</span>

Q_bias = np.zeros(<span class="code-number">16</span>)  <span class="code-comment"># åå·®é€šå¸¸åˆå§‹åŒ–ç‚º 0</span>

<span class="code-comment"># Kã€V æ¬Šé‡ä¹Ÿæ˜¯é¡ä¼¼çš„éš¨æ©Ÿåˆå§‹åŒ–</span></pre>
                    </div>
                </div>
            </div>

            <div class="step-box">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <span class="step-number">2</span>
                    <span class="step-title">è¨“ç·´éç¨‹ï¼ˆTrainingï¼‰</span>
                </div>
                <p>æ¨¡å‹åœ¨å¤§é‡æ•¸æ“šä¸Šè¨“ç·´ï¼Œé€é<strong>æ¢¯åº¦ä¸‹é™</strong>ï¼ˆGradient Descentï¼‰ä¸æ–·èª¿æ•´é€™äº›æ¬Šé‡ã€‚</p>
                
                <div class="matrix-box" style="margin-top: 20px;">
                    <div class="code-visualization">
                        <pre><span class="code-comment"># è¨“ç·´å¾ªç’°ï¼ˆç°¡åŒ–ç‰ˆï¼‰</span>
<span class="code-keyword">for</span> epoch <span class="code-keyword">in</span> <span class="code-keyword">range</span>(num_epochs):
    <span class="code-keyword">for</span> batch <span class="code-keyword">in</span> training_data:
        <span class="code-comment"># 1. å‰å‘å‚³æ’­ï¼ˆForward Passï¼‰</span>
        predictions = model(batch)
        
        <span class="code-comment"># 2. è¨ˆç®—æå¤±ï¼ˆLossï¼‰</span>
        loss = compute_loss(predictions, targets)
        
        <span class="code-comment"># 3. åå‘å‚³æ’­ï¼ˆBackward Passï¼‰</span>
        gradients = compute_gradients(loss)
        
        <span class="code-comment"># 4. æ›´æ–°æ¬Šé‡</span>
        Q_weights = Q_weights - learning_rate * gradients[<span class="code-string">'Q_weights'</span>]
        K_weights = K_weights - learning_rate * gradients[<span class="code-string">'K_weights'</span>]
        V_weights = V_weights - learning_rate * gradients[<span class="code-string">'V_weights'</span>]
        
        <span class="code-comment"># åå·®ä¹ŸåŒæ¨£æ›´æ–°</span>
        Q_bias = Q_bias - learning_rate * gradients[<span class="code-string">'Q_bias'</span>]
        <span class="code-comment"># ...</span></pre>
                    </div>
                </div>
            </div>

            <div class="step-box">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <span class="step-number">3</span>
                    <span class="step-title">è¨“ç·´å®Œæˆï¼ˆTrained Weightsï¼‰</span>
                </div>
                <p>ç¶“éæ•¸ç™¾è¬æ¬¡çš„æ›´æ–°å¾Œï¼Œæ¬Šé‡å·²ç¶“ã€Œå­¸æœƒã€äº†å¦‚ä½•æœ€å¥½åœ°æå–è³‡è¨Šã€‚</p>
                <p style="margin-top: 15px;">é€™äº›è¨“ç·´å¥½çš„æ¬Šé‡è¢«<strong>ä¿å­˜</strong>ä¸‹ä¾†ï¼Œå°±æ˜¯æˆ‘å€‘åœ¨æ¨ç†ï¼ˆinferenceï¼‰æ™‚ä½¿ç”¨çš„æ¨¡å‹åƒæ•¸ã€‚</p>
            </div>

            <h3>ğŸ”„ æ¯å€‹ Head çš„æ¬Šé‡éƒ½ä¸åŒå—ï¼Ÿ</h3>

            <div class="pull-quote">
                <strong>æ˜¯çš„ï¼æ¯å€‹ head éƒ½æœ‰è‡ªå·±ç¨ç«‹çš„ Q/K/V æ¬Šé‡çŸ©é™£ã€‚</strong><br><br>
                é€™å°±æ˜¯ç‚ºä»€éº¼å¤šå€‹ heads èƒ½å­¸ç¿’<strong>ä¸åŒçš„é—œæ³¨æ¨¡å¼</strong>ã€‚
            </div>

            <figure>
                <img src="../../images/weights_structure_multihead_20260105214909.png" alt="Multi-Head æ¬Šé‡çµæ§‹">
                <figcaption>
                    è¦–è¦ºåŒ–ï¼š3 å€‹ heads å„è‡ªæ“æœ‰ç¨ç«‹çš„æ¬Šé‡çŸ©é™£
                </figcaption>
            </figure>

            <div class="matrix-box">
                <div class="matrix-title">nano-gpt çš„å®Œæ•´æ¬Šé‡çµæ§‹</div>
                <div class="code-visualization">
                    <pre><span class="code-comment"># nano-gpt æœ‰ 3 å€‹ attention heads</span>

<span class="code-comment"># Head 1 çš„æ¬Šé‡ï¼ˆç¨ç«‹ï¼‰</span>
Head1_Q_weights: [<span class="code-number">16</span> Ã— <span class="code-number">48</span>] = <span class="code-number">768</span> åƒæ•¸
Head1_K_weights: [<span class="code-number">16</span> Ã— <span class="code-number">48</span>] = <span class="code-number">768</span> åƒæ•¸
Head1_V_weights: [<span class="code-number">16</span> Ã— <span class="code-number">48</span>] = <span class="code-number">768</span> åƒæ•¸
Head1_biases: <span class="code-number">16</span> + <span class="code-number">16</span> + <span class="code-number">16</span> = <span class="code-number">48</span> åƒæ•¸
Head1 ç¸½è¨ˆï¼š<span class="code-number">2,352</span> åƒæ•¸

<span class="code-comment"># Head 2 çš„æ¬Šé‡ï¼ˆç¨ç«‹ï¼‰</span>
Head2_Q_weights: [<span class="code-number">16</span> Ã— <span class="code-number">48</span>] = <span class="code-number">768</span> åƒæ•¸
Head2_K_weights: [<span class="code-number">16</span> Ã— <span class="code-number">48</span>] = <span class="code-number">768</span> åƒæ•¸
Head2_V_weights: [<span class="code-number">16</span> Ã— <span class="code-number">48</span>] = <span class="code-number">768</span> åƒæ•¸
Head2_biases: <span class="code-number">48</span> åƒæ•¸
Head2 ç¸½è¨ˆï¼š<span class="code-number">2,352</span> åƒæ•¸

<span class="code-comment"># Head 3 çš„æ¬Šé‡ï¼ˆç¨ç«‹ï¼‰</span>
Head3_Q_weights: [<span class="code-number">16</span> Ã— <span class="code-number">48</span>] = <span class="code-number">768</span> åƒæ•¸
Head3_K_weights: [<span class="code-number">16</span> Ã— <span class="code-number">48</span>] = <span class="code-number">768</span> åƒæ•¸
Head3_V_weights: [<span class="code-number">16</span> Ã— <span class="code-number">48</span>] = <span class="code-number">768</span> åƒæ•¸
Head3_biases: <span class="code-number">48</span> åƒæ•¸
Head3 ç¸½è¨ˆï¼š<span class="code-number">2,352</span> åƒæ•¸

<span class="code-comment">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="code-comment"># 3 å€‹ heads çš„ Q/K/V æ¬Šé‡ç¸½è¨ˆ</span>
<span class="code-number">2,352</span> Ã— <span class="code-number">3</span> = <span class="code-number">7,056</span> å€‹åƒæ•¸

<span class="code-comment"># æ¯å€‹ head çš„æ¬Šé‡å®Œå…¨ç¨ç«‹ï¼</span>
<span class="code-comment"># è¨“ç·´æ™‚å„è‡ªå­¸ç¿’ä¸åŒçš„ç‰¹å¾µ</span></pre>
                </div>
            </div>

            <div class="info-box">
                <div class="info-box-title">
                    <span>ğŸ“</span>
                    <span>ç‚ºä»€éº¼éœ€è¦ç¨ç«‹çš„æ¬Šé‡ï¼Ÿ</span>
                </div>
                <ul style="margin-left: 20px; line-height: 2;">
                    <li><strong>å¤šæ¨£æ€§</strong>ï¼šæ¯å€‹ head å¯ä»¥å­¸ç¿’ä¸åŒçš„é—œæ³¨æ¨¡å¼
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>Head 1 å¯èƒ½é—œæ³¨<strong>èªæ³•é—œä¿‚</strong>ï¼ˆä¸»è©-å‹•è©ï¼‰</li>
                            <li>Head 2 å¯èƒ½é—œæ³¨<strong>èªç¾©ç›¸ä¼¼æ€§</strong>ï¼ˆåŒç¾©è©ï¼‰</li>
                            <li>Head 3 å¯èƒ½é—œæ³¨<strong>ä½ç½®é—œä¿‚</strong>ï¼ˆç›¸é„°è©å½™ï¼‰</li>
                        </ul>
                    </li>
                    <li><strong>å†—é¤˜æ€§</strong>ï¼šå¦‚æœæŸå€‹ head å­¸ç¿’å¤±æ•—ï¼Œå…¶ä»– heads å¯ä»¥å½Œè£œ</li>
                    <li><strong>è±å¯Œè¡¨å¾µ</strong>ï¼šçµ„åˆå¤šå€‹è¦–è§’ï¼Œç²å¾—æ›´å®Œæ•´çš„ç†è§£</li>
                </ul>
            </div>

            <h3>ğŸ” æ¬Šé‡çš„å¯¦éš›ä½œç”¨</h3>

            <div class="matrix-box" style="background: linear-gradient(135deg, #1e3a2f 0%, #0f1e18 100%);">
                <div class="matrix-title" style="color: var(--matrix-green);">æ¬Šé‡å¦‚ä½•å½±éŸ¿ Q/K/V å‘é‡</div>
                <div class="code-visualization">
                    <pre><span class="code-comment"># å‡è¨­è¼¸å…¥å‘é‡ä»£è¡¨ã€ŒéŠ€è¡Œã€é€™å€‹è©</span>
input = [<span class="code-number">0.5</span>, <span class="code-number">-0.2</span>, <span class="code-number">0.8</span>, ...] <span class="code-comment"># [48 ç¶­]</span>

<span class="code-comment"># Head 1 å¯èƒ½å­¸æœƒã€Œå•ã€ï¼šé€™æ˜¯é‡‘èæ©Ÿæ§‹å—ï¼Ÿ</span>
Head1_Q_weights = [
    [<span class="code-number">0.9</span>, <span class="code-number">0.1</span>, ...],  <span class="code-comment"># å¼·èª¿ã€Œé‡‘èã€ç‰¹å¾µ</span>
    ...
]
Q1 = Head1_Q_weights @ input  <span class="code-comment"># ç”¢ç”Ÿã€Œé‡‘èèªå¢ƒã€çš„ Query</span>

<span class="code-comment"># Head 2 å¯èƒ½å­¸æœƒã€Œå•ã€ï¼šé€™æ˜¯åœ°ç†ä½ç½®å—ï¼Ÿ</span>
Head2_Q_weights = [
    [<span class="code-number">0.1</span>, <span class="code-number">0.8</span>, ...],  <span class="code-comment"># å¼·èª¿ã€Œåœ°ç†ã€ç‰¹å¾µ</span>
    ...
]
Q2 = Head2_Q_weights @ input  <span class="code-comment"># ç”¢ç”Ÿã€Œåœ°ç†èªå¢ƒã€çš„ Query</span>

<span class="code-comment"># åŒä¸€å€‹è¼¸å…¥ï¼Œä¸åŒçš„æ¬Šé‡ â†’ ä¸åŒçš„ Queryï¼</span>
<span class="code-comment"># é€™å°±æ˜¯å¤šé ­æ³¨æ„åŠ›çš„åŠ›é‡</span></pre>
                </div>
            </div>

            <div class="info-box" style="background: linear-gradient(135deg, rgba(255, 215, 0, 0.1) 0%, rgba(255, 215, 0, 0.05) 100%); border-color: var(--gold);">
                <div class="info-box-title" style="color: var(--gold);">
                    <span>ğŸ’¡</span>
                    <span>ç¸½çµï¼šæ¬Šé‡çŸ©é™£çš„æœ¬è³ª</span>
                </div>
                <p style="font-size: 1.1rem; line-height: 2;">
                    æ¬Šé‡çŸ©é™£æ˜¯æ¨¡å‹çš„<strong>ã€ŒçŸ¥è­˜ã€</strong>ï¼š<br>
                </p>
                <ul style="margin-left: 20px; line-height: 2; margin-top: 15px;">
                    <li>ğŸ“š é€éè¨“ç·´å¾æ•¸æ“šä¸­<strong>å­¸ç¿’</strong>è€Œä¾†</li>
                    <li>ğŸ¯ æ¯å€‹ head æœ‰<strong>ç¨ç«‹</strong>çš„æ¬Šé‡çŸ©é™£</li>
                    <li>ğŸ”„ è¨“ç·´éç¨‹ä¸­ä¸æ–·<strong>æ›´æ–°å„ªåŒ–</strong></li>
                    <li>ğŸ’¾ è¨“ç·´å®Œæˆå¾Œè¢«<strong>ä¿å­˜</strong>åœ¨æ¨¡å‹æ–‡ä»¶ä¸­</li>
                    <li>ğŸš€ æ¨ç†æ™‚<strong>å›ºå®šä¸è®Š</strong>ï¼Œç”¨æ–¼ç”Ÿæˆé æ¸¬</li>
                </ul>
                <p style="margin-top: 20px; padding: 20px; background: rgba(255,255,255,0.8); border-radius: 10px;">
                    <strong>å¯¦éš›ä¾‹å­ï¼š</strong><br>
                    ç•¶ä½ ä¸‹è¼‰ä¸€å€‹ã€ŒGPT-2 æ¨¡å‹æ–‡ä»¶ã€ï¼ˆä¾‹å¦‚ 500MBï¼‰ï¼Œä½ ä¸‹è¼‰çš„ä¸»è¦å°±æ˜¯é€™äº›æ¬Šé‡çŸ©é™£çš„æ•¸å€¼ï¼<br>
                    æ¨¡å‹çš„ã€Œæ™ºèƒ½ã€å°±å„²å­˜åœ¨é€™äº›æ•¸å­—è£¡ã€‚
                </p>
            </div>

            <h2>ğŸ’¡ Q/K/V çš„å‘½åå«ç¾©</h2>

            <p>é€™äº›åç¨±ä¾†è‡ªè»Ÿé«”é–‹ç™¼ä¸­çš„ã€Œå­—å…¸ã€ï¼ˆdictionaryï¼‰æ¦‚å¿µï¼š</p>

            <div class="matrix-box" style="background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);">
                <div class="matrix-title" style="color: var(--attention-brown);">è»Ÿé«”é¡æ¯”</div>
                <div class="code-visualization">
                    <pre><span class="code-comment"># è»Ÿé«”ä¸­çš„å­—å…¸ï¼ˆDictionary/Mapï¼‰</span>

<span class="code-comment"># 1. å»ºç«‹æŸ¥æ‰¾è¡¨</span>
table = {
    <span class="code-string">"key0"</span>: <span class="code-string">"value0"</span>,
    <span class="code-string">"key1"</span>: <span class="code-string">"value1"</span>,
    <span class="code-string">"key2"</span>: <span class="code-string">"value2"</span>,
}

<span class="code-comment"># 2. ä½¿ç”¨ query æŸ¥æ‰¾</span>
result = table[<span class="code-string">"key1"</span>]  <span class="code-comment"># è¿”å› "value1"</span></pre>
                </div>
            </div>

            <div class="info-box">
                <div class="info-box-title">
                    <span>ğŸ”‘</span>
                    <span>Self-Attention çš„ã€Œå­—å…¸ã€</span>
                </div>
                <p>åœ¨ Self-Attention ä¸­ï¼Œæ¦‚å¿µé¡ä¼¼ä½†æ›´éˆæ´»ï¼š</p>
                <ul style="margin-left: 20px; line-height: 2; margin-top: 15px;">
                    <li><strong>Key (K)</strong>ï¼šå°±åƒå­—å…¸çš„éµï¼Œæ¨™è­˜ã€Œæˆ‘æœ‰ä»€éº¼è³‡è¨Šã€</li>
                    <li><strong>Value (V)</strong>ï¼šå°±åƒå­—å…¸çš„å€¼ï¼Œå­˜å„²ã€Œå¯¦éš›çš„è³‡è¨Šå…§å®¹ã€</li>
                    <li><strong>Query (Q)</strong>ï¼šç”¨ä¾†æŸ¥è©¢ï¼Œå•ã€Œæˆ‘éœ€è¦å“ªäº›è³‡è¨Šã€</li>
                    <li><strong>å·®ç•°</strong>ï¼šä¸æ˜¯è¿”å›å–®ä¸€æ¢ç›®ï¼Œè€Œæ˜¯è¿”å›æ‰€æœ‰æ¢ç›®çš„<strong>åŠ æ¬Šçµ„åˆ</strong></li>
                </ul>
            </div>

            <h2>ğŸ¬ ä¸‹ä¸€æ­¥ï¼šä½¿ç”¨ Q/K/V</h2>

            <p>ç¾åœ¨æˆ‘å€‘å·²ç¶“ç‚ºæ¯å€‹ token ç”Ÿæˆäº† Qã€Kã€V ä¸‰å€‹å‘é‡ï¼Œæ¥ä¸‹ä¾†å‘¢ï¼Ÿ</p>

            <div class="pull-quote">
                åœ¨ä¸‹ä¸€ç« ï¼ˆSelf-Attention ä¸‹åŠéƒ¨ï¼‰ï¼Œ<br>
                æˆ‘å€‘å°‡å­¸ç¿’å¦‚ä½•ä½¿ç”¨é€™äº›å‘é‡ï¼š<br><br>
                ç”¨ <strong>Q</strong> æŸ¥è©¢å…¶ä»– tokens çš„ <strong>K</strong>ï¼Œ<br>
                æ‰¾å‡ºç›¸é—œæ€§å¾Œï¼Œæå–å°æ‡‰çš„ <strong>V</strong>ã€‚
            </div>

            <div class="comparison-grid">
                <div class="comparison-card" style="border-top-color: #4682b4;">
                    <div class="card-title">â†’ ç¬¬å››ç« </div>
                    <p><strong>Self-Attentionï¼ˆä¸‹ï¼‰</strong></p>
                    <p>è¨ˆç®— Attention Scoreã€Softmaxã€ç”¢ç”Ÿè¼¸å‡º</p>
                </div>

                <div class="comparison-card" style="border-top-color: var(--purple);">
                    <div class="card-title">â†’ ç¬¬äº”ç« </div>
                    <p><strong>Multi-Head Attention</strong></p>
                    <p>å¹³è¡Œè™•ç†å¤šå€‹ attention heads</p>
                </div>

                <div class="comparison-card" style="border-top-color: #87ceeb;">
                    <div class="card-title">â†’ ç¬¬å…­ç« </div>
                    <p><strong>Feed Forward Network</strong></p>
                    <p>Transformer Block çš„ç¬¬äºŒå€‹ä¸»è¦çµ„ä»¶</p>
                </div>
            </div>

            <h2 style="margin-top: 80px;">ğŸ—ºï¸ å›é¡§æ¶æ§‹å…¨è²Œ</h2>

            <div class="info-box" style="background: linear-gradient(135deg, rgba(218, 165, 32, 0.1) 0%, rgba(218, 165, 32, 0.05) 100%); border-color: var(--attention-brown);">
                <div class="info-box-title" style="color: var(--attention-brown);">
                    <span>ğŸ“</span>
                    <span>Self-Attentionï¼ˆQ/K/Vï¼‰åœ¨å®Œæ•´æ¶æ§‹ä¸­çš„ä½ç½®</span>
                </div>
                <figure style="margin: 20px 0 0 0;">
                    <img src="../../images/llm_architecture_full_20260105210724.png" alt="LLM å®Œæ•´æ¶æ§‹" style="max-width: 100%; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.2);">
                    <figcaption style="margin-top: 20px; font-size: 1rem; color: #666; line-height: 1.8;">
                        å®Œæ•´æ¶æ§‹åœ–ï¼šæˆ‘å€‘å‰›å‰›å®Œæˆäº† <span style="color: #daa520; font-weight: 700;">Self-Attention çš„ç¬¬ä¸€éƒ¨åˆ†ï¼ˆQ/K/V ç”Ÿæˆï¼‰</span>ï¼Œ<br>
                        æ¥ä¸‹ä¾†å°‡ç¹¼çºŒ Self-Attention çš„ç¬¬äºŒéƒ¨åˆ†ï¼ˆAttention è¨ˆç®—ï¼‰
                    </figcaption>
                </figure>
                <div style="text-align: center; margin-top: 30px;">
                    <a href="../index.html" style="display: inline-block; padding: 15px 40px; background: var(--attention-brown); color: #0a0e27; text-decoration: none; border-radius: 50px; font-weight: 700; transition: transform 0.3s ease;">
                        â† è¿”å›æ•™å­¸é¦–é æŸ¥çœ‹æ‰€æœ‰ç« ç¯€
                    </a>
                </div>
            </div>

        </div>
    </div>

    <!-- Chapter Navigation -->
    <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); padding: 60px 40px; margin-top: 80px;">
        <div style="max-width: 900px; margin: 0 auto;">
            
            <h2 style="font-family: 'Noto Serif TC', serif; font-size: 2rem; color: #0a0e27; text-align: center; margin-bottom: 40px; border: none; padding: 0;">
                ğŸ¯ æœ¬ç« é‡é»å›é¡§
            </h2>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(230px, 1fr)); gap: 20px; margin-bottom: 50px;">
                <div style="background: white; padding: 25px; border-radius: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                    <div style="font-size: 2rem; margin-bottom: 10px;">ğŸ“Š</div>
                    <div style="font-weight: 700; color: #0a0e27; margin-bottom: 8px;">Q/K/V å‘é‡ç”Ÿæˆ</div>
                    <div style="font-size: 0.95rem; color: #666; line-height: 1.6;">é€éçŸ©é™£-å‘é‡ä¹˜æ³•ç”Ÿæˆä¸‰ç¨®å‘é‡</div>
                </div>

                <div style="background: white; padding: 25px; border-radius: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                    <div style="font-size: 2rem; margin-bottom: 10px;">ğŸ”¢</div>
                    <div style="font-weight: 700; color: #0a0e27; margin-bottom: 8px;">æ¬Šé‡çŸ©é™£ [16Ã—48]</div>
                    <div style="font-size: 0.95rem; color: #666; line-height: 1.6;">å›ºå®šæ¬Šé‡è™•ç†å¯è®Šé•·åº¦è¼¸å…¥</div>
                </div>

                <div style="background: white; padding: 25px; border-radius: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                    <div style="font-size: 2rem; margin-bottom: 10px;">ğŸ²</div>
                    <div style="font-weight: 700; color: #0a0e27; margin-bottom: 8px;">æ¬Šé‡éš¨æ©Ÿåˆå§‹åŒ–</div>
                    <div style="font-size: 0.95rem; color: #666; line-height: 1.6;">è¨“ç·´éç¨‹ä¸­å­¸ç¿’æœ€ä½³æ¬Šé‡</div>
                </div>

                <div style="background: white; padding: 25px; border-radius: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                    <div style="font-size: 2rem; margin-bottom: 10px;">ğŸ”‘</div>
                    <div style="font-weight: 700; color: #0a0e27; margin-bottom: 8px;">æ¯å€‹ Head ç¨ç«‹æ¬Šé‡</div>
                    <div style="font-size: 0.95rem; color: #666; line-height: 1.6;">å¢åŠ è¡¨å¾µå¤šæ¨£æ€§</div>
                </div>
            </div>

            <div style="border-top: 2px solid #dee2e6; padding-top: 40px; margin-top: 40px;">
                <h3 style="font-family: 'Noto Serif TC', serif; font-size: 1.5rem; color: #0a0e27; text-align: center; margin-bottom: 30px;">
                    ğŸ“š ç« ç¯€å°èˆª
                </h3>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
                    <a href="02-layer-normalization.html" style="display: flex; align-items: center; gap: 15px; padding: 25px; background: white; border-radius: 15px; text-decoration: none; color: #0a0e27; transition: transform 0.3s ease, box-shadow 0.3s ease; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                        <div style="font-size: 2rem;">â¬…ï¸</div>
                        <div>
                            <div style="font-size: 0.85rem; color: #666; margin-bottom: 5px;">ä¸Šä¸€ç« </div>
                            <div style="font-weight: 700; font-size: 1.1rem;">Layer Normalization</div>
                            <div style="font-size: 0.9rem; color: #999; margin-top: 3px;">æ­£è¦åŒ–èˆ‡ç©©å®šæ€§</div>
                        </div>
                    </a>

                    <a href="03b-self-attention-computation.html" style="display: flex; align-items: center; justify-content: flex-end; gap: 15px; padding: 25px; background: linear-gradient(135deg, #ffd700 0%, #f0c000 100%); border-radius: 15px; text-decoration: none; color: #0a0e27; transition: transform 0.3s ease, box-shadow 0.3s ease; box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);">
                        <div style="text-align: right;">
                            <div style="font-size: 0.85rem; opacity: 0.8; margin-bottom: 5px;">ä¸‹ä¸€ç« </div>
                            <div style="font-weight: 700; font-size: 1.1rem;">Self-Attention: è¨ˆç®—éç¨‹</div>
                            <div style="font-size: 0.9rem; opacity: 0.9; margin-top: 5px;">è¨ˆç®—æ³¨æ„åŠ›åˆ†æ•¸èˆ‡åŠ æ¬Šå’Œ</div>
                        </div>
                        <div style="font-size: 2rem;">â¡ï¸</div>
                    </a>
                </div>

                <div style="text-align: center; padding: 20px; background: rgba(255, 215, 0, 0.1); border-radius: 12px; border: 2px dashed var(--gold);">
                    <div style="font-size: 0.95rem; color: #666; line-height: 1.8;">
                        <strong style="color: #0a0e27;">ğŸ’¡ ä¸‹ä¸€æ­¥å­¸ä»€éº¼ï¼Ÿ</strong><br>
                        æœ‰äº† Q/K/V å‘é‡ï¼Œæ¥ä¸‹ä¾†è¦è¨ˆç®—å®ƒå€‘çš„<strong style="color: var(--gold);">é»ç©</strong>ä¾†ç”¢ç”Ÿæ³¨æ„åŠ›åˆ†æ•¸ï¼Œ<br>
                        ç†è§£å“ªäº› tokens æ‡‰è©²äº’ç›¸é—œæ³¨ã€‚é€™æ˜¯ Self-Attention çš„æ ¸å¿ƒè¨ˆç®—ï¼
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Footer Quote -->
    <div class="footer-quote">
        <p class="footer-quote-text">
            ã€ŒQ/K/Vï¼šä¸‰å€‹å‘é‡ï¼Œ<br>
            é–‹å•Ÿäº† tokens ä¹‹é–“çš„å°è©±ä¹‹é–€ã€‚ã€
        </p>
        <p class="footer-quote-author">â€” LLM è¦–è¦ºåŒ–æ•™å­¸ Â· 2026</p>
    </div>

</body>
</html>

