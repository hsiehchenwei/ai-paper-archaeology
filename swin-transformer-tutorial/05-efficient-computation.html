<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜æ•ˆè¨ˆç®— - Swin Transformer æ·±åº¦è§£æ</title>
    <link rel="stylesheet" href="../styles/global.css">
    <link rel="stylesheet" href="../styles/paper-reading.css">
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
    <div class="container">
        <!-- Hero Section -->
        <div class="hero-section" style="background-image: url('images/generated/hero_05_efficient_computation.png');">
            <div class="hero-overlay"></div>
            <div class="hero-content">
                <h1>Cyclic-Shiftï¼šå·§å¦™çš„æ‰¹æ¬¡è¨ˆç®—</h1>
                <p class="hero-subtitle">å¾ 2.25 å€é–‹éŠ·åˆ°é«˜æ•ˆå¯¦ç¾</p>
                <div class="hero-meta">Swin Transformer æ·±åº¦è§£æ Â· ç¬¬ 5 ç« </div>
            </div>
        </div>

        <!-- Breadcrumb -->
        <nav class="breadcrumb">
            <a href="../index.html">ğŸ  é¦–é </a>
            <span>/</span>
            <a href="index.html">Swin Transformer æ·±åº¦è§£æ</a>
            <span>/</span>
            <span class="current">ç¬¬ 5 ç« ï¼šé«˜æ•ˆè¨ˆç®—</span>
        </nav>

        <div class="story-container">
            <!-- Drop Cap é–‹å ´ -->
            <p class="drop-cap">
                Shifted Windows å¸¶ä¾†äº†ä¸€å€‹æ–°çš„æŒ‘æˆ°ï¼šç§»ä½å¾Œçš„è¦–çª—æ•¸é‡æœƒå¢åŠ ï¼Œè€Œä¸”æœ‰äº›è¦–çª—æœƒè®Šå°ã€‚å¦‚æœç°¡å–®åœ°ç”¨ padding å¡«å……ï¼Œè¨ˆç®—é‡æœƒå¢åŠ  2.25 å€ã€‚Swin Transformer æå‡ºäº†ä¸€å€‹å·§å¦™çš„è§£æ±ºæ–¹æ¡ˆï¼šCyclic-Shiftï¼ˆå¾ªç’°ç§»ä½ï¼‰ã€‚é€šéå°‡ç‰¹å¾µåœ–å¾ªç’°ç§»ä½ï¼Œç„¶å¾Œä½¿ç”¨ masking æ©Ÿåˆ¶ï¼Œæ—¢ä¿æŒäº†æ‰¹æ¬¡è¨ˆç®—çš„æ•ˆç‡ï¼Œåˆå¯¦ç¾äº†ç§»ä½è¦–çª—çš„æ•ˆæœã€‚
            </p>

            <div class="section-divider"><span>âœ¦</span></div>

            <h2>ç§»ä½è¦–çª—çš„è¨ˆç®—æŒ‘æˆ°</h2>

            <div class="original-quote">
                <div class="content">
                    <div class="en">
                        <strong>ğŸ“„ è«–æ–‡åŸæ–‡</strong><br><br>
                        An issue with shifted window partitioning is that it will result in more windows, from $\lceil \frac{h}{M}\rceil  \times \lceil\frac{w}{M}\rceil$  to $(\lceil \frac{h}{M}\rceil +1) \times (\lceil\frac{w}{M}\rceil + 1)$ in the shifted configuration, and some of the windows will be smaller than $M\times M$. A naive solution is to pad the smaller windows to a size of $M\times M$ and mask out the padded values when computing attention. When the number of windows in regular partitioning is small, e.g. $2\times 2$, the increased computation with this naive solution is considerable ($2\times 2 \rightarrow 3\times 3$, which is 2.25 times greater).
                    </div>
                    <div class="zh">
                        <strong>ç¿»è­¯</strong><br><br>
                        ç§»ä½è¦–çª—åˆ†å€çš„ä¸€å€‹å•é¡Œæ˜¯å®ƒæœƒå°è‡´æ›´å¤šçš„è¦–çª—ï¼Œå¾ âŒˆh/MâŒ‰ Ã— âŒˆw/MâŒ‰ å¢åŠ åˆ°ç§»ä½é…ç½®ä¸­çš„ (âŒˆh/MâŒ‰ + 1) Ã— (âŒˆw/MâŒ‰ + 1)ï¼Œä¸¦ä¸”ä¸€äº›è¦–çª—æœƒå°æ–¼ MÃ—Mã€‚ä¸€å€‹ç°¡å–®çš„è§£æ±ºæ–¹æ¡ˆæ˜¯å°‡è¼ƒå°çš„è¦–çª—å¡«å……åˆ° MÃ—M çš„å¤§å°ï¼Œä¸¦åœ¨è¨ˆç®—æ³¨æ„åŠ›æ™‚é®ç½©å¡«å……å€¼ã€‚ç•¶å¸¸è¦åˆ†å€ä¸­çš„è¦–çª—æ•¸é‡è¼ƒå°‘æ™‚ï¼Œä¾‹å¦‚ 2Ã—2ï¼Œä½¿ç”¨é€™ç¨®ç°¡å–®è§£æ±ºæ–¹æ¡ˆçš„è¨ˆç®—å¢åŠ æ˜¯ç›¸ç•¶å¯è§€çš„ï¼ˆ2Ã—2 â†’ 3Ã—3ï¼Œå³ 2.25 å€ï¼‰ã€‚
                    </div>
                </div>
            </div>

            <div class="key-concept">
                <h4>âš ï¸ å•é¡Œåˆ†æ</h4>
                <ul>
                    <li><strong>è¦–çª—æ•¸é‡å¢åŠ </strong>ï¼šå¾ 2Ã—2 å¢åŠ åˆ° 3Ã—3ï¼ˆå¢åŠ  2.25 å€ï¼‰</li>
                    <li><strong>è¦–çª—å¤§å°ä¸ä¸€è‡´</strong>ï¼šæœ‰äº›è¦–çª—å°æ–¼ MÃ—M</li>
                    <li><strong>ç°¡å–®æ–¹æ¡ˆçš„å•é¡Œ</strong>ï¼šPadding æœƒå°è‡´è¨ˆç®—é‡å¤§å¹…å¢åŠ </li>
                </ul>
            </div>

            <div class="section-divider"><span>âœ¦</span></div>

            <h2>Cyclic-Shift çš„å·§å¦™è§£æ±ºæ–¹æ¡ˆ</h2>

            <div class="original-quote">
                <div class="content">
                    <div class="en">
                        <strong>ğŸ“„ è«–æ–‡åŸæ–‡</strong><br><br>
                        Here, we propose a <em>more efficient batch computation approach</em> by cyclic-shifting toward the top-left direction, as illustrated in Figure 4. After this shift, a batched window may be composed of several sub-windows that are not adjacent in the feature map, so a masking mechanism is employed to limit self-attention computation to within each sub-window. With the cyclic-shift, the number of batched windows remains the same as that of regular window partitioning, and thus is also efficient.
                    </div>
                    <div class="zh">
                        <strong>ç¿»è­¯</strong><br><br>
                        åœ¨é€™è£¡ï¼Œæˆ‘å€‘æå‡ºäº†ä¸€å€‹<em>æ›´é«˜æ•ˆçš„æ‰¹æ¬¡è¨ˆç®—æ–¹æ³•</em>ï¼Œé€šéå‘å·¦ä¸Šæ–¹å‘é€²è¡Œå¾ªç’°ç§»ä½ï¼Œå¦‚åœ– 4 æ‰€ç¤ºã€‚åœ¨é€™å€‹ç§»ä½ä¹‹å¾Œï¼Œä¸€å€‹æ‰¹æ¬¡è¦–çª—å¯èƒ½ç”±ç‰¹å¾µåœ–ä¸­ä¸ç›¸é„°çš„å¹¾å€‹å­è¦–çª—çµ„æˆï¼Œå› æ­¤ä½¿ç”¨é®ç½©æ©Ÿåˆ¶å°‡è‡ªæ³¨æ„åŠ›è¨ˆç®—é™åˆ¶åœ¨æ¯å€‹å­è¦–çª—å…§ã€‚é€šéå¾ªç’°ç§»ä½ï¼Œæ‰¹æ¬¡è¦–çª—çš„æ•¸é‡èˆ‡å¸¸è¦è¦–çª—åˆ†å€ä¿æŒç›¸åŒï¼Œå› æ­¤ä¹Ÿæ˜¯é«˜æ•ˆçš„ã€‚
                    </div>
                </div>
            </div>

            <!-- åŸå§‹åœ–ç‰‡å±•ç¤º -->
            <div class="figure figure-original">
                <img src="images/original/HiT-layer2.png" alt="é«˜æ•ˆæ‰¹æ¬¡è¨ˆç®—ç¤ºæ„åœ–">
                <div class="caption">
                    <strong>Figure 4:</strong> é«˜æ•ˆæ‰¹æ¬¡è¨ˆç®—æ–¹æ³•ç¤ºæ„åœ–ï¼ˆè«–æ–‡åŸåœ–ï¼‰
                </div>
                <div class="explanation">
                    <h4>ğŸ–¼ï¸ åŸæ–‡åœ–è¡¨è§£æ</h4>
                    <p>
                        é€™å¼µåœ–å±•ç¤ºäº† Cyclic-Shift çš„å·§å¦™è¨­è¨ˆï¼š
                    </p>
                    <ul>
                        <li><strong>æ­¥é©Ÿ 1</strong>ï¼šå°‡ç‰¹å¾µåœ–å¾ªç’°ç§»ä½ï¼ˆcyclic-shiftï¼‰</li>
                        <li><strong>æ­¥é©Ÿ 2</strong>ï¼šé‡æ–°åŠƒåˆ†è¦–çª—ï¼Œç¾åœ¨æ‰€æœ‰è¦–çª—éƒ½æ˜¯å®Œæ•´çš„ MÃ—M å¤§å°</li>
                        <li><strong>æ­¥é©Ÿ 3</strong>ï¼šä½¿ç”¨ masking æ©Ÿåˆ¶ï¼Œç¢ºä¿æ¯å€‹å­è¦–çª—å…§çš„æ³¨æ„åŠ›è¨ˆç®—ä¸æœƒè·¨è¶Šé‚Šç•Œ</li>
                        <li><strong>æ­¥é©Ÿ 4</strong>ï¼šåå‘ç§»ä½ï¼Œæ¢å¾©åŸå§‹ä½ç½®</li>
                    </ul>
                    <p>
                        é€™ç¨®æ–¹æ³•ä¿æŒäº†è¦–çª—æ•¸é‡ä¸è®Šï¼Œé¿å…äº†è¨ˆç®—é‡çš„å¢åŠ ï¼ŒåŒæ™‚å¯¦ç¾äº†ç§»ä½è¦–çª—çš„æ•ˆæœã€‚
                    </p>
                </div>
            </div>

            <!-- é›™é‡é¡æ¯” -->
            <div class="analogy-section">
                <div class="analogy-card life">
                    <h4>ğŸ  ç”Ÿæ´»é¡æ¯”</h4>
                    <p>
                        å°±åƒæ‹¼åœ–é‡çµ„ä¸€æ¨£ï¼šç•¶ä½ æœ‰ä¸€å¡Šä¸è¦å‰‡çš„æ‹¼åœ–å€åŸŸæ™‚ï¼Œä½ å¯ä»¥å°‡æ•´å€‹æ‹¼åœ–æ¿ã€Œå¾ªç’°ç§»å‹•ã€ï¼Œè®“ä¸è¦å‰‡çš„éƒ¨åˆ†ç§»å‹•åˆ°é‚Šç·£ï¼Œç„¶å¾Œé‡æ–°åŠƒåˆ†å€åŸŸã€‚é€™æ¨£æ‰€æœ‰å€åŸŸéƒ½æ˜¯å®Œæ•´çš„çŸ©å½¢ï¼Œè™•ç†èµ·ä¾†æ›´é«˜æ•ˆã€‚è™•ç†å®Œå¾Œï¼Œå†å°‡æ‹¼åœ–æ¿ã€Œç§»å›ã€åŸä½ï¼Œå°±å¾—åˆ°äº†æ­£ç¢ºçš„çµæœã€‚
                    </p>
                </div>
                <div class="analogy-card engineering">
                    <h4>âš™ï¸ å·¥ç¨‹é¡æ¯”</h4>
                    <p>
                        åœ¨ç³»çµ±æ¶æ§‹ä¸Šï¼Œé€™é¡ä¼¼æ–¼è¨˜æ†¶é«”æ˜ å°„ï¼ˆMemory Mappingï¼‰çš„æŠ€è¡“ï¼šç•¶æ•¸æ“šåœ¨è¨˜æ†¶é«”ä¸­çš„åˆ†ä½ˆä¸è¦å‰‡æ™‚ï¼Œå¯ä»¥é€šéã€Œè™›æ“¬è¨˜æ†¶é«”æ˜ å°„ã€å°‡ä¸è¦å‰‡çš„æ•¸æ“šé‡æ–°çµ„ç¹”æˆè¦å‰‡çš„å¡Šï¼Œé€²è¡Œé«˜æ•ˆè™•ç†ï¼Œç„¶å¾Œå†æ˜ å°„å›åŸå§‹ä½ç½®ã€‚Cyclic-Shift å°±æ˜¯é€™ç¨®ã€Œè™›æ“¬é‡çµ„ã€çš„å¯¦ç¾ï¼Œæ—¢ä¿æŒäº†æ•¸æ“šçš„é‚è¼¯é—œä¿‚ï¼Œåˆå„ªåŒ–äº†è¨ˆç®—æ•ˆç‡ã€‚
                    </p>
                </div>
            </div>

            <div class="section-divider"><span>âœ¦</span></div>

            <h2>ç›¸å°ä½ç½®åç½®ï¼ˆRelative Position Biasï¼‰</h2>

            <div class="original-quote">
                <div class="content">
                    <div class="en">
                        <strong>ğŸ“„ è«–æ–‡åŸæ–‡</strong><br><br>
                        In computing self-attention, we follow previous works by including a relative position bias $B \in \mathbb{R}^{M^2 \times M^2}$ to each head in computing similarity:
                        \begin{equation}
                            \text{Attention}(Q, K, V) = \text{SoftMax}(QK^T/\sqrt{d}+B)V,
                        \end{equation}
                        where $Q, K, V \in \mathbb{R}^{M^2\times d}$ are the <em>query</em>, <em>key</em> and <em>value</em> matrices; $d$ is the <em>query</em>/<em>key</em> dimension, and $M^2$ is the number of patches in a window. Since the relative position along each axis lies in the range $[-M+1, M-1]$, we parameterize a smaller-sized bias matrix $\hat{B} \in \mathbb{R}^{(2M-1)\times (2M-1)}$, and values in $B$ are taken from $\hat{B}$.
                    </div>
                    <div class="zh">
                        <strong>ç¿»è­¯</strong><br><br>
                        åœ¨è¨ˆç®—è‡ªæ³¨æ„åŠ›æ™‚ï¼Œæˆ‘å€‘éµå¾ªå…ˆå‰çš„å·¥ä½œï¼Œåœ¨è¨ˆç®—ç›¸ä¼¼åº¦æ™‚ç‚ºæ¯å€‹é ­åŒ…å«ä¸€å€‹ç›¸å°ä½ç½®åç½® B âˆˆ â„^(MÂ²Ã—MÂ²)ï¼š
                        \begin{equation}
                            \text{Attention}(Q, K, V) = \text{SoftMax}(QK^T/\sqrt{d}+B)V,
                        \end{equation}
                        å…¶ä¸­ Q, K, V âˆˆ â„^(MÂ²Ã—d) æ˜¯ <em>query</em>ã€<em>key</em> å’Œ <em>value</em> çŸ©é™£ï¼›d æ˜¯ <em>query</em>/<em>key</em> ç¶­åº¦ï¼ŒMÂ² æ˜¯è¦–çª—ä¸­ patch çš„æ•¸é‡ã€‚ç”±æ–¼æ²¿æ¯å€‹è»¸çš„ç›¸å°ä½ç½®åœ¨ [-M+1, M-1] ç¯„åœå…§ï¼Œæˆ‘å€‘åƒæ•¸åŒ–ä¸€å€‹è¼ƒå°å°ºå¯¸çš„åç½®çŸ©é™£ BÌ‚ âˆˆ â„^((2M-1)Ã—(2M-1))ï¼ŒB ä¸­çš„å€¼å–è‡ª BÌ‚ã€‚
                    </div>
                </div>
            </div>

            <div class="key-concept">
                <h4>ğŸ’¡ ç›¸å°ä½ç½®åç½®çš„å„ªå‹¢</h4>
                <ul>
                    <li><strong>å¹³ç§»ä¸è®Šæ€§</strong>ï¼šç›¸å°ä½ç½®åç½®è®“æ¨¡å‹å°åœ–åƒçš„å¹³ç§»æ›´åŠ é­¯æ£’</li>
                    <li><strong>åƒæ•¸æ•ˆç‡</strong>ï¼šä½¿ç”¨ (2M-1)Ã—(2M-1) çš„åç½®çŸ©é™£ï¼Œè€Œä¸æ˜¯ MÂ²Ã—MÂ²</li>
                    <li><strong>å¯¦é©—é©—è­‰</strong>ï¼šç›¸æ¯”çµ•å°ä½ç½®åµŒå…¥ï¼Œåœ¨å¯†é›†é æ¸¬ä»»å‹™ä¸Šè¡¨ç¾æ›´å¥½</li>
                </ul>
            </div>

            <div class="section-divider"><span>âœ¦</span></div>

            <h2>å¯¦é©—çµæœï¼šæ•ˆç‡æå‡</h2>

            <div class="original-quote">
                <div class="content">
                    <div class="en">
                        <strong>ğŸ“„ è«–æ–‡åŸæ–‡</strong><br><br>
                        We observe significant improvements over counterparts without this bias term or that use absolute position embedding, as shown in Table 4. Further adding absolute position embedding to the input as in ViT drops performance slightly, thus it is not adopted in our implementation.
                    </div>
                    <div class="zh">
                        <strong>ç¿»è­¯</strong><br><br>
                        æˆ‘å€‘è§€å¯Ÿåˆ°ç›¸æ¯”æ²’æœ‰åç½®é …æˆ–ä½¿ç”¨çµ•å°ä½ç½®åµŒå…¥çš„å°æ‡‰æ–¹æ³•æœ‰é¡¯è‘—æ”¹é€²ï¼Œå¦‚è¡¨ 4 æ‰€ç¤ºã€‚é€²ä¸€æ­¥åƒ ViT é‚£æ¨£åœ¨è¼¸å…¥ä¸­æ·»åŠ çµ•å°ä½ç½®åµŒå…¥æœƒç•¥å¾®é™ä½æ€§èƒ½ï¼Œå› æ­¤åœ¨æˆ‘å€‘çš„å¯¦ç¾ä¸­ä¸æ¡ç”¨ã€‚
                    </div>
                </div>
            </div>

            <!-- Quote Block é‡‘å¥ -->
            <div class="quote-block">
                ã€ŒCyclic-Shift + Masking = é«˜æ•ˆçš„ç§»ä½è¦–çª—å¯¦ç¾ã€
            </div>

            <!-- æœ¬ç« é‡é»å›é¡§ -->
            <div class="chapter-summary">
                <h3>ğŸ’¡ æœ¬ç« é‡é»</h3>
                <ul>
                    <li><strong>ç§»ä½è¦–çª—çš„æŒ‘æˆ°</strong>ï¼šè¦–çª—æ•¸é‡å¢åŠ ï¼Œè¦–çª—å¤§å°ä¸ä¸€è‡´</li>
                    <li><strong>Cyclic-Shift è§£æ±ºæ–¹æ¡ˆ</strong>ï¼šå¾ªç’°ç§»ä½ + masking æ©Ÿåˆ¶ï¼Œä¿æŒè¦–çª—æ•¸é‡ä¸è®Š</li>
                    <li><strong>æ•ˆç‡å„ªå‹¢</strong>ï¼šç›¸æ¯”ç°¡å–® padding æ–¹æ¡ˆï¼Œé¿å…äº† 2.25 å€çš„è¨ˆç®—å¢åŠ </li>
                    <li><strong>ç›¸å°ä½ç½®åç½®</strong>ï¼šä½¿ç”¨ (2M-1)Ã—(2M-1) çš„åƒæ•¸çŸ©é™£ï¼Œæ¯”çµ•å°ä½ç½®åµŒå…¥æ›´æœ‰æ•ˆ</li>
                    <li><strong>å¯¦é©—é©—è­‰</strong>ï¼šåœ¨ä¸‰å€‹ä»»å‹™ä¸Šéƒ½å¸¶ä¾†é¡¯è‘—æ€§èƒ½æå‡</li>
                </ul>
            </div>
        </div>

        <!-- Navigation -->
        <div class="chapter-nav">
            <a href="04-shifted-windows.html" class="prev">â† ä¸Šä¸€ç« </a>
            <a href="index.html" class="home">ğŸ“‘ ç›®éŒ„</a>
            <a href="06-experiments.html" class="next">ä¸‹ä¸€ç« ï¼šå¯¦é©—çµæœ â†’</a>
        </div>
    </div>
</body>
</html>
